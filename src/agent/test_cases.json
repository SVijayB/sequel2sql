{
  "dialect": "PostgreSQL",
  "version": "14.12",
  "instance_id": "PostgreSQL_0",
  "db_id": "financial",
  "query": "I'm trying to identify accounts with significant transaction variability in our PostgreSQL database. Specifically, I need to find accounts that have made at least two transactions where the difference between their highest and lowest transaction amounts exceeds 12000. I've tried writing a query to find this information, but I'm getting incorrect results. The issue seems to be with how I'm filtering the data or calculating the differences. Could someone help me fix the following issue SQL to properly identify accounts meeting these criteria?",
  "issue_sql": [
    "SELECT account_id, MAX(payments) AS max_payment, MIN(payments) AS min_payment FROM loan GROUP BY account_id HAVING COUNT(account_id) > 1 AND (MAX(payments) - MIN(payments)) > 2;"
  ],
  "preprocess_sql": [],
  "clean_up_sql": [],
  "category": "Query",
  "preprocess_schema": "CREATE TABLE \"account\" (\naccount_id bigint NOT NULL DEFAULT '0'::bigint,\ndistrict_id bigint NULL DEFAULT '0'::bigint,\nfrequency text NULL,\ndate date NULL,\n    PRIMARY KEY (account_id),\n    FOREIGN KEY (district_id) REFERENCES district(district_id)\n);\n\nFirst 3 rows:\n  account_id    district_id  frequency         date\n------------  -------------  ----------------  ----------\n           1             18  POPLATEK MESICNE  1995-03-24\n           2              1  POPLATEK MESICNE  1993-02-26\n           3              5  POPLATEK MESICNE  1997-07-07\n...\n\n\nCREATE TABLE \"card\" (\ncard_id bigint NOT NULL DEFAULT '0'::bigint,\ndisp_id bigint NULL,\ntype text NULL,\nissued date NULL,\n    PRIMARY KEY (card_id),\n    FOREIGN KEY (disp_id) REFERENCES disp(disp_id)\n);\n\nFirst 3 rows:\n  card_id    disp_id  type     issued\n---------  ---------  -------  ----------\n        1          9  gold     1998-10-16\n        2         19  classic  1998-03-13\n        3         41  gold     1995-09-03\n...\n\n\nCREATE TABLE \"client\" (\nclient_id bigint NOT NULL,\ngender text NULL,\nbirth_date date NULL,\ndistrict_id bigint NULL,\n    PRIMARY KEY (client_id),\n    FOREIGN KEY (district_id) REFERENCES district(district_id)\n);\n\nFirst 3 rows:\n  client_id  gender    birth_date      district_id\n-----------  --------  ------------  -------------\n          1  F         1970-12-13               18\n          2  M         1945-02-04                1\n          3  F         1940-10-09                1\n...\n\n\nCREATE TABLE \"disp\" (\ndisp_id bigint NOT NULL,\nclient_id bigint NULL,\naccount_id bigint NULL,\ntype text NULL,\n    PRIMARY KEY (disp_id),\n    FOREIGN KEY (account_id) REFERENCES account(account_id),\n    FOREIGN KEY (client_id) REFERENCES client(client_id)\n);\n\nFirst 3 rows:\n  disp_id    client_id    account_id  type\n---------  -----------  ------------  ---------\n        1            1             1  OWNER\n        2            2             2  OWNER\n        3            3             2  DISPONENT\n...\n\n\nCREATE TABLE \"district\" (\ndistrict_id bigint NOT NULL DEFAULT '0'::bigint,\na2 text NULL,\na3 text NULL,\na4 text NULL,\na5 text NULL,\na6 text NULL,\na7 text NULL,\na8 bigint NULL,\na9 bigint NULL,\na10 real NULL,\na11 bigint NULL,\na12 real NULL,\na13 real NULL,\na14 bigint NULL,\na15 bigint NULL,\na16 bigint NULL,\n    PRIMARY KEY (district_id)\n);\n\nFirst 3 rows:\n  district_id  a2           a3                    a4    a5    a6    a7    a8    a9    a10    a11    a12    a13    a14    a15    a16\n-------------  -----------  ---------------  -------  ----  ----  ----  ----  ----  -----  -----  -----  -----  -----  -----  -----\n            1  Hl.m. Praha  Prague           1204953     0     0     0     1     1  100    12541    0.2   0.43    167  85677  99107\n            2  Benesov      central Bohemia    88884    80    26     6     2     5   46.7   8507    1.6   1.85    132   2159   2674\n            3  Beroun       central Bohemia    75232    55    26     4     1     5   41.7   8980    1.9   2.21    111   2824   2813\n...\n\n\nCREATE TABLE \"loan\" (\nloan_id bigint NOT NULL DEFAULT '0'::bigint,\naccount_id bigint NULL,\ndate date NULL,\namount bigint NULL,\nduration bigint NULL,\npayments real NULL,\nstatus text NULL,\n    PRIMARY KEY (loan_id),\n    FOREIGN KEY (account_id) REFERENCES account(account_id)\n);\n\nFirst 3 rows:\n  loan_id    account_id  date          amount    duration    payments  status\n---------  ------------  ----------  --------  ----------  ----------  --------\n     4959             2  1994-01-05     80952          24        3373  A\n     4961            19  1996-04-29     30276          12        2523  B\n     4962            25  1997-12-08     30276          12        2523  A\n...\n\n\nCREATE TABLE \"order\" (\norder_id bigint NOT NULL DEFAULT '0'::bigint,\naccount_id bigint NULL,\nbank_to text NULL,\naccount_to bigint NULL,\namount real NULL,\nk_symbol text NULL,\n    PRIMARY KEY (order_id),\n    FOREIGN KEY (account_id) REFERENCES account(account_id)\n);\n\nFirst 3 rows:\n  order_id    account_id  bank_to      account_to    amount  k_symbol\n----------  ------------  ---------  ------------  --------  ----------\n     29401             1  YZ             87144583    2452    SIPO\n     29402             2  ST             89597016    3372.7  UVER\n     29403             2  QR             13943797    7266    SIPO\n...\n\n\nCREATE TABLE \"trans\" (\ntrans_id bigint NOT NULL DEFAULT '0'::bigint,\naccount_id bigint NULL DEFAULT '0'::bigint,\ndate date NULL,\ntype text NULL,\noperation text NULL,\namount bigint NULL,\nbalance bigint NULL,\nk_symbol text NULL,\nbank text NULL,\naccount bigint NULL,\n    PRIMARY KEY (trans_id),\n    FOREIGN KEY (account_id) REFERENCES account(account_id)\n);\n\nFirst 3 rows:\n  trans_id    account_id  date        type    operation        amount    balance  k_symbol    bank          account\n----------  ------------  ----------  ------  -------------  --------  ---------  ----------  ------  -------------\n         1             1  1995-03-24  PRIJEM  VKLAD              1000       1000                      nan\n         5             1  1995-04-13  PRIJEM  PREVOD Z UCTU      3679       4679              AB        4.14033e+07\n         6             1  1995-05-13  PRIJEM  PREVOD Z UCTU      3679      20977              AB        4.14033e+07\n...\n"
}