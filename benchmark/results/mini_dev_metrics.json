[
  {
    "query_idx": 0,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN Currency = 'EUR' THEN 1 ...",
    "valid": true,
    "duration_ms": 23.059606552124023,
    "estimated_tokens": 139,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN Currency = 'EUR' THEN 1 ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN Currency = 'CZK' THEN 1 ELSE 0 END), 0) FROM customers",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 1,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T1.CustomerID FROM customers AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 7.513999938964844,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.CustomerID FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'LAM' AND SUBSTR(T2.Date, 1, 4) = '2012' GROUP BY T1.CustomerID ORDER BY SUM(T2.Consumption) ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 2,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT AVG(T2.Consumption) / NULLIF(12, 0) FROM cu...",
    "valid": true,
    "duration_ms": 7.165670394897461,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.Consumption) / NULLIF(12, 0) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTR(T2.Date, 1, 4) = '2013' AND T1.Segment = 'SME'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 3,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(CASE WHEN T1.Currency = 'CZK' THEN CAST...",
    "valid": true,
    "duration_ms": 9.026288986206055,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T1.Currency = 'CZK' THEN CAST(T2.Consumption AS float) ELSE 0 END) -SUM(CASE WHEN T1.Currency = 'EUR' THEN CAST(T2.Consumption AS float) ELSE 0 END) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE substring(T2.Date, 1, 4) = '2012'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 4,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUBSTR(T2.Date, 1, 4) FROM customers AS T1 ...",
    "valid": true,
    "duration_ms": 6.934881210327148,
    "estimated_tokens": 181,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUBSTR(T2.Date, 1, 4) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' GROUP BY SUBSTR(T2.Date, 1, 4) ORDER BY SUM(T2.Consumption) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 5,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUBSTR(T2.Date, 5, 2) FROM customers AS T1 ...",
    "valid": true,
    "duration_ms": 6.99615478515625,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUBSTR(T2.Date, 5, 2) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE SUBSTR(T2.Date, 1, 4) = '2013' AND T1.Segment = 'SME' GROUP BY SUBSTR(T2.Date, 5, 2) ORDER BY SUM(T2.Consumption) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 6,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.Segment = 'SME' THEN ...",
    "valid": true,
    "duration_ms": 26.70001983642578,
    "estimated_tokens": 434,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.Segment = 'SME' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0) - CAST(SUM(CASE WHEN T1.Segment = 'LAM' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0), CAST(SUM(CASE WHEN T1.Segment = 'LAM' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0) - CAST(SUM(CASE WHEN T1.Segment = 'KAM' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0), CAST(SUM(CASE WHEN T1.Segment = 'KAM' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0) - CAST(SUM(CASE WHEN T1.Segment = 'SME' THEN T2.Consumption ELSE 0 END) AS REAL) / NULLIF(COUNT(T1.CustomerID), 0) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Currency = 'CZK' AND T2.Consumption = (SELECT MIN(Consumption) FROM yearmonth) AND T2.Date::text BETWEEN '201301' AND '201312'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.20800000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 13
      }
    }
  },
  {
    "query_idx": 7,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST((SUM(CASE WHEN T1.Segment = 'SME' AND ...",
    "valid": true,
    "duration_ms": 32.56940841674805,
    "estimated_tokens": 469,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST((SUM(CASE WHEN T1.Segment = 'SME' AND T2.Date LIKE '2013%' THEN T2.Consumption ELSE 0 END) - SUM(CASE WHEN T1.Segment = 'SME' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END)) AS REAL) * 100 / NULLIF(SUM(CASE WHEN T1.Segment = 'SME' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END), 0), CAST(SUM(CASE WHEN T1.Segment = 'LAM' AND T2.Date LIKE '2013%' THEN T2.Consumption ELSE 0 END) - SUM(CASE WHEN T1.Segment = 'LAM' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END) AS REAL) * 100 / NULLIF(SUM(CASE WHEN T1.Segment = 'LAM' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END), 0), CAST(SUM(CASE WHEN T1.Segment = 'KAM' AND T2.Date LIKE '2013%' THEN T2.Consumption ELSE 0 END) - SUM(CASE WHEN T1.Segment = 'KAM' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END) AS REAL) * 100 / NULLIF(SUM(CASE WHEN T1.Segment = 'KAM' AND T2.Date LIKE '2012%' THEN T2.Consumption ELSE 0 END), 0) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.189,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 9
      }
    }
  },
  {
    "query_idx": 8,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(Consumption) FROM yearmonth WHERE Custo...",
    "valid": true,
    "duration_ms": 3.534078598022461,
    "estimated_tokens": 112,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(Consumption) FROM yearmonth WHERE CustomerID = 6 AND Date BETWEEN '201308' AND '201311'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 9,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(CASE WHEN Country = 'CZE' THEN 1 ELSE 0...",
    "valid": true,
    "duration_ms": 5.040168762207031,
    "estimated_tokens": 124,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN Country = 'CZE' THEN 1 ELSE 0 END) - SUM(CASE WHEN Country = 'SVK' THEN 1 ELSE 0 END) FROM gasstations WHERE Segment = 'Discount'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 10,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(CASE WHEN Currency = 'CZK' THEN 1 ELSE ...",
    "valid": true,
    "duration_ms": 5.678415298461914,
    "estimated_tokens": 123,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN Currency = 'CZK' THEN 1 ELSE 0 END) - SUM(CASE WHEN Currency = 'EUR' THEN 1 ELSE 0 END) FROM customers WHERE Segment = 'SME'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 11,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.Consumption > 46.73 T...",
    "valid": true,
    "duration_ms": 8.570194244384766,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.Consumption > 46.73 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.CustomerID), 0) FROM customers AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Segment = 'LAM'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 12,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN Consumption > 528.3 THEN...",
    "valid": true,
    "duration_ms": 4.684209823608398,
    "estimated_tokens": 134,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN Consumption > 528.3 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(CustomerID), 0) FROM yearmonth WHERE Date = '201202'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 13,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(CAST(Consumption AS float)) FROM yearmo...",
    "valid": true,
    "duration_ms": 5.017280578613281,
    "estimated_tokens": 147,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CAST(Consumption AS float)) FROM yearmonth WHERE SUBSTR(Date, 1, 4) = '2012' GROUP BY SUBSTR(Date, 5, 2) ORDER BY SUM(Consumption) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 14,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T3.Description FROM transactions_1k AS T1 I...",
    "valid": true,
    "duration_ms": 4.792451858520508,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.Description FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID INNER JOIN products AS T3 ON T1.ProductID = T3.ProductID WHERE T2.Date = '201309'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 15,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT DISTINCT T2.Country FROM transactions_1k AS...",
    "valid": true,
    "duration_ms": 5.680084228515625,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN yearmonth AS T3 ON T1.CustomerID = T3.CustomerID WHERE T3.Date = '201306'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 16,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT COUNT(*) FROM yearmonth AS T1 INNER JOIN cu...",
    "valid": true,
    "duration_ms": 4.532337188720703,
    "estimated_tokens": 138,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM yearmonth AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.Currency = 'EUR' AND T1.Consumption > 1000.00",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 17,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT DISTINCT T3.Description FROM transactions_1...",
    "valid": true,
    "duration_ms": 5.076885223388672,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.Description FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN products AS T3 ON T1.ProductID = T3.ProductID WHERE T2.Country = 'CZE'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 18,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT DISTINCT T1.Time FROM transactions_1k AS T1...",
    "valid": true,
    "duration_ms": 4.002809524536133,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.Time FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.ChainID = 11",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 19,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT COUNT(T1.TransactionID) FROM transactions_1...",
    "valid": true,
    "duration_ms": 5.528926849365234,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T2.Country = 'CZE' AND TO_CHAR(CAST(T1.Date AS TIMESTAMP), 'YYYY') >= '2012'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 20,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT DISTINCT T3.Currency FROM transactions_1k A...",
    "valid": true,
    "duration_ms": 5.017995834350586,
    "estimated_tokens": 181,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.Currency FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN customers AS T3 ON T1.CustomerID = T3.CustomerID WHERE T1.Date = '2012-08-24' AND T1.Time = '16:25:00'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 21,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T2.Segment FROM transactions_1k AS T1 INNER...",
    "valid": true,
    "duration_ms": 4.034280776977539,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Segment FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.date = '2012-08-23' AND T1.time = '21:20:00'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 22,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT COUNT(T1.TransactionID) FROM transactions_1...",
    "valid": true,
    "duration_ms": 5.708456039428711,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.TransactionID) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-26' AND T1.Time BETWEEN '08:00:00' AND '09:00:00' AND T2.Country = 'CZE'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 23,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T2.Country FROM transactions_1k AS T1 INNER...",
    "valid": true,
    "duration_ms": 2.9909610748291016,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Country FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-24' AND T1.Price = '548.4'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 24,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.Currency = 'EUR' THEN...",
    "valid": true,
    "duration_ms": 5.501985549926758,
    "estimated_tokens": 177,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.Currency = 'EUR' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.CustomerID), 0) FROM transactions_1k AS T1 INNER JOIN customers AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Date = '2012-08-25'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 25,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN SUBSTR(Date, 1, 4) = '20...",
    "valid": true,
    "duration_ms": 13.978958129882812,
    "estimated_tokens": 286,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END) - SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2013' THEN Consumption ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN SUBSTR(Date, 1, 4) = '2012' THEN Consumption ELSE 0 END), 0) FROM yearmonth WHERE CustomerID = (SELECT T1.CustomerID FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID WHERE T1.Date = '2012-08-25' AND T1.Price = 1513.12 )",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.17300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 26,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN Country = 'SVK' AND Segm...",
    "valid": true,
    "duration_ms": 6.737709045410156,
    "estimated_tokens": 137,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN Country = 'SVK' AND Segment = 'Premium' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(SUM(CASE WHEN Country = 'SVK' THEN 1 ELSE 0 END), 0) FROM gasstations",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.032,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 27,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT SUM(T1.Price ), SUM(CASE WHEN T3.Date = '20...",
    "valid": true,
    "duration_ms": 5.029916763305664,
    "estimated_tokens": 198,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(T1.Price ), SUM(CASE WHEN T3.Date = '201201' THEN T1.Price ELSE 0 END) FROM transactions_1k AS T1 INNER JOIN gasstations AS T2 ON T1.GasStationID = T2.GasStationID INNER JOIN yearmonth AS T3 ON T1.CustomerID = T3.CustomerID WHERE T1.CustomerID = '38508'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 28,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T2.CustomerID, SUM(T2.Price / NULLIF(T2.Amo...",
    "valid": true,
    "duration_ms": 7.264614105224609,
    "estimated_tokens": 209,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.CustomerID, SUM(T2.Price / NULLIF(T2.Amount, 0)), T1.Currency FROM customers AS T1 INNER JOIN transactions_1k AS T2 ON T1.CustomerID = T2.CustomerID WHERE T2.CustomerID = (SELECT CustomerID FROM yearmonth ORDER BY Consumption DESC NULLS LAST LIMIT 1) GROUP BY T2.CustomerID, T1.Currency",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 29,
    "db_id": "debit_card_specializing",
    "sql_snippet": "SELECT T2.Consumption FROM transactions_1k AS T1 I...",
    "valid": true,
    "duration_ms": 3.9949417114257812,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Consumption FROM transactions_1k AS T1 INNER JOIN yearmonth AS T2 ON T1.CustomerID = T2.CustomerID WHERE T1.Price / NULLIF(T1.Amount, 0) > 29.00 AND T1.ProductID = 5 AND T2.Date = '201208'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 30,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.major_name FROM member AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.21905517578125,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.major_name FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T1.first_name = 'Angela' AND T1.last_name = 'Sanders'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 31,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(T1.event_id) FROM event AS T1 INNER J...",
    "valid": true,
    "duration_ms": 4.53495979309082,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.event_id) FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event INNER JOIN member AS T3 ON T2.link_to_member = T3.member_id WHERE T1.event_name = 'Women''s Soccer' AND T3.t_shirt_size = 'Medium'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 32,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.event_id) FROM event AS T...",
    "valid": true,
    "duration_ms": 4.014730453491211,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.event_id) FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event WHERE T1.type = 'Meeting' GROUP BY T1.event_id HAVING COUNT(T2.link_to_event) > 10",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07100000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 33,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.event_name FROM event AS T1 INNER JOIN a...",
    "valid": true,
    "duration_ms": 7.260799407958984,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.event_name FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event GROUP BY T1.event_id HAVING COUNT(T2.link_to_event) > 20 EXCEPT SELECT T1.event_name FROM event AS T1 WHERE T1.type = 'Fundraiser'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.065,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING-EXCEPT",
        "clauses_present": [
          "EXCEPT",
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 34,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.amount FROM member AS T1 INNER JOIN inco...",
    "valid": true,
    "duration_ms": 3.998994827270508,
    "estimated_tokens": 147,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.amount FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T1.position = 'Vice President'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 35,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.first_name, T1.last_name FROM member AS ...",
    "valid": true,
    "duration_ms": 4.612207412719727,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN zip_code AS T2 ON T1.zip = T2.zip_code WHERE T2.state = 'Illinois'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 36,
    "db_id": "student_club",
    "sql_snippet": "SELECT T3.approved FROM event AS T1 INNER JOIN bud...",
    "valid": true,
    "duration_ms": 5.288124084472656,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.approved FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget WHERE T1.event_name = 'October Meeting' AND T1.event_date LIKE '2019-10-08%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 37,
    "db_id": "student_club",
    "sql_snippet": "SELECT AVG(T2.cost) FROM member AS T1 INNER JOIN e...",
    "valid": true,
    "duration_ms": 6.6623687744140625,
    "estimated_tokens": 206,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.cost) FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member WHERE T1.last_name = 'Allen' AND T1.first_name = 'Elijah' AND (SUBSTR(T2.expense_date, 6, 2) = '09' OR SUBSTR(T2.expense_date, 6, 2) = '10')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 38,
    "db_id": "student_club",
    "sql_snippet": "SELECT SUM(CASE WHEN SUBSTR(T1.event_date, 1, 4) =...",
    "valid": true,
    "duration_ms": 6.737232208251953,
    "estimated_tokens": 205,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN SUBSTR(T1.event_date, 1, 4) = '2019' THEN T2.spent ELSE 0 END) - SUM(CASE WHEN SUBSTR(T1.event_date, 1, 4) = '2020' THEN T2.spent ELSE 0 END) AS num FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 39,
    "db_id": "student_club",
    "sql_snippet": "SELECT notes FROM income WHERE source = 'Fundraisi...",
    "valid": true,
    "duration_ms": 2.534151077270508,
    "estimated_tokens": 120,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT notes FROM income WHERE source = 'Fundraising' AND date_received = '2019-09-14'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.027000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 40,
    "db_id": "student_club",
    "sql_snippet": "SELECT phone FROM member WHERE first_name = 'Carlo...",
    "valid": true,
    "duration_ms": 2.000570297241211,
    "estimated_tokens": 113,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT phone FROM member WHERE first_name = 'Carlo' AND last_name = 'Jacobs'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.027000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 41,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.event_status FROM budget AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.6885738372802734,
    "estimated_tokens": 173,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.event_status FROM budget AS T1 INNER JOIN expense AS T2 ON T1.budget_id = T2.link_to_budget WHERE T2.expense_description = 'Post Cards, Posters' AND T2.expense_date = '2019-08-20'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 42,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.major_name FROM member AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 2.537250518798828,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.major_name FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T1.first_name = 'Brent' AND T1.last_name = 'Thomason'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 43,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(T1.member_id) FROM member AS T1 INNER...",
    "valid": true,
    "duration_ms": 5.015373229980469,
    "estimated_tokens": 151,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.member_id) FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T2.major_name = 'Business' AND T1.t_shirt_size = 'Medium'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 44,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.department FROM member AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 2.6645660400390625,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.department FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T1.position = 'President'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 45,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.date_received FROM member AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 3.9854049682617188,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.date_received FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T1.first_name = 'Connor' AND T1.last_name = 'Hilton' AND T2.source = 'Dues'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 46,
    "db_id": "student_club",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.event_name = 'Yearly ...",
    "valid": true,
    "duration_ms": 6.738424301147461,
    "estimated_tokens": 213,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.event_name = 'Yearly Kickoff' THEN T1.amount ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN T2.event_name = 'October Meeting' THEN T1.amount ELSE 0 END), 0) FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T1.category = 'Advertisement' AND T2.type = 'Meeting'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 47,
    "db_id": "student_club",
    "sql_snippet": "SELECT SUM(cost) FROM expense WHERE expense_descri...",
    "valid": true,
    "duration_ms": 2.62451171875,
    "estimated_tokens": 93,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(cost) FROM expense WHERE expense_description = 'Pizza'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 48,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(city) FROM zip_code WHERE county = 'O...",
    "valid": true,
    "duration_ms": 3.001689910888672,
    "estimated_tokens": 100,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(city) FROM zip_code WHERE county = 'Orange County' AND state = 'Virginia'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 49,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.major_name FROM member AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 6.045103073120117,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.major_name FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T1.phone = '809-555-3360'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 50,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(T2.link_to_member) FROM event AS T1 I...",
    "valid": true,
    "duration_ms": 5.1441192626953125,
    "estimated_tokens": 143,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.link_to_member) FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event WHERE T1.event_name = 'Women''s Soccer'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 51,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.first_name, T1.last_name FROM member AS ...",
    "valid": true,
    "duration_ms": 2.9993057250976562,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN major AS T2 ON T1.link_to_major = T2.major_id WHERE T2.department = 'School of Applied Sciences, Technology and Education'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 52,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.event_name FROM budget AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 5.087614059448242,
    "estimated_tokens": 181,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.event_name FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T2.status = 'Closed' ORDER BY T1.spent / NULLIF(T1.amount, 0) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 53,
    "db_id": "student_club",
    "sql_snippet": "SELECT MAX(spent) FROM budget",
    "valid": true,
    "duration_ms": 2.697467803955078,
    "estimated_tokens": 81,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT MAX(spent) FROM budget",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.016,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 54,
    "db_id": "student_club",
    "sql_snippet": "SELECT SUM(spent) FROM budget WHERE category = 'Fo...",
    "valid": true,
    "duration_ms": 1.9998550415039062,
    "estimated_tokens": 91,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(spent) FROM budget WHERE category = 'Food'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 55,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.first_name, T1.last_name FROM member AS ...",
    "valid": true,
    "duration_ms": 3.994464874267578,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.first_name, T1.last_name FROM member AS T1 INNER JOIN attendance AS T2 ON T1.member_id = T2.link_to_member GROUP BY T1.member_id, T1.first_name, T1.last_name HAVING COUNT(T2.link_to_event) > 7",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 56,
    "db_id": "student_club",
    "sql_snippet": "SELECT T4.first_name, T4.last_name FROM event AS T...",
    "valid": true,
    "duration_ms": 6.062746047973633,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T4.first_name, T4.last_name FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget INNER JOIN member AS T4 ON T3.link_to_member = T4.member_id WHERE T1.event_name = 'Yearly Kickoff'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 57,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.event_name FROM event AS T1 INNER JOIN b...",
    "valid": true,
    "duration_ms": 5.996227264404297,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.event_name FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget ORDER BY T3.cost NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 58,
    "db_id": "student_club",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.event_name = 'Yearly ...",
    "valid": true,
    "duration_ms": 6.304025650024414,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.event_name = 'Yearly Kickoff' THEN T3.cost ELSE 0 END) AS REAL) * 100 / NULLIF(SUM(T3.cost), 0) FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.092,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 59,
    "db_id": "student_club",
    "sql_snippet": "SELECT source FROM income WHERE date_received BETW...",
    "valid": true,
    "duration_ms": 2.0155906677246094,
    "estimated_tokens": 130,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT source FROM income WHERE date_received BETWEEN '2019-09-01' AND '2019-09-30' ORDER BY source DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 60,
    "db_id": "student_club",
    "sql_snippet": "SELECT COUNT(T2.member_id) FROM major AS T1 INNER ...",
    "valid": true,
    "duration_ms": 4.998445510864258,
    "estimated_tokens": 139,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.member_id) FROM major AS T1 INNER JOIN member AS T2 ON T1.major_id = T2.link_to_major WHERE T1.major_name = 'Physics Teaching'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 61,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.event_name FROM budget AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 3.563404083251953,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.event_name FROM budget AS T1 INNER JOIN event AS T2 ON T1.link_to_event = T2.event_id WHERE T1.category = 'Advertisement' ORDER BY T1.spent DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 62,
    "db_id": "student_club",
    "sql_snippet": "SELECT CASE WHEN T3.event_name = 'Women''s Soccer'...",
    "valid": true,
    "duration_ms": 6.012439727783203,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN T3.event_name = 'Women''s Soccer' THEN 'YES' END AS result FROM member AS T1 INNER JOIN attendance AS T2 ON T1.member_id = T2.link_to_member INNER JOIN event AS T3 ON T2.link_to_event = T3.event_id WHERE T1.first_name = 'Maya' AND T1.last_name = 'Mclean'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 63,
    "db_id": "student_club",
    "sql_snippet": "SELECT T3.cost FROM event AS T1 INNER JOIN budget ...",
    "valid": true,
    "duration_ms": 5.014896392822266,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.cost FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget WHERE T1.event_name = 'September Speaker' AND T3.expense_description = 'Posters'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 64,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.event_name FROM budget AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.278659820556641,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.event_name FROM budget AS T1 INNER JOIN event AS T2 ON T2.event_id = T1.link_to_event WHERE T1.event_status = 'Closed' AND T1.remaining < 0 ORDER BY T1.remaining NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 65,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.type, SUM(T3.cost) FROM event AS T1 INNE...",
    "valid": true,
    "duration_ms": 5.013227462768555,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.type, SUM(T3.cost) FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event INNER JOIN expense AS T3 ON T2.budget_id = T3.link_to_budget WHERE T1.event_name = 'October Meeting' GROUP BY T1.type",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.093,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 66,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.category, SUM(T2.amount) FROM event AS T...",
    "valid": true,
    "duration_ms": 4.002094268798828,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.category, SUM(T2.amount) FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event WHERE T1.event_name = 'April Speaker' GROUP BY T2.category ORDER BY SUM(T2.amount) ASC",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 67,
    "db_id": "student_club",
    "sql_snippet": "SELECT SUM(cost) FROM expense WHERE expense_date =...",
    "valid": true,
    "duration_ms": 1.5146732330322266,
    "estimated_tokens": 102,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(cost) FROM expense WHERE expense_date = '2019-08-20'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 68,
    "db_id": "student_club",
    "sql_snippet": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) F...",
    "valid": true,
    "duration_ms": 4.523515701293945,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.first_name, T1.last_name, SUM(T2.cost) FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member WHERE T1.member_id = 'rec4BLdZHS2Blfp4v' GROUP BY T1.first_name, T1.last_name",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 69,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.expense_description FROM member AS T1 IN...",
    "valid": true,
    "duration_ms": 2.5277137756347656,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.expense_description FROM member AS T1 INNER JOIN expense AS T2 ON T1.member_id = T2.link_to_member WHERE T1.first_name = 'Sacha' AND T1.last_name = 'Harrison'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 70,
    "db_id": "student_club",
    "sql_snippet": "SELECT DISTINCT T2.category FROM event AS T1 INNER...",
    "valid": true,
    "duration_ms": 2.9811859130859375,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.category FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event WHERE T1.location = 'MU 215'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 71,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.last_name, T1.department, T1.college FRO...",
    "valid": true,
    "duration_ms": 4.384279251098633,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.last_name, T1.department, T1.college FROM major AS T1 INNER JOIN member AS T2 ON T1.major_id = T2.link_to_major WHERE T2.position = 'Member' AND T1.major_name = 'Environmental Engineering'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 72,
    "db_id": "student_club",
    "sql_snippet": "SELECT DISTINCT T2.category, T1.type FROM event AS...",
    "valid": true,
    "duration_ms": 4.999399185180664,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.category, T1.type FROM event AS T1 INNER JOIN budget AS T2 ON T1.event_id = T2.link_to_event WHERE T1.location = 'MU 215' AND T2.spent = 0 AND T1.type = 'Guest Speaker'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 73,
    "db_id": "student_club",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.amount = 50 THEN 1.0 ...",
    "valid": true,
    "duration_ms": 6.00123405456543,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.amount = 50 THEN 1.0 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T2.income_id), 0) FROM member AS T1 INNER JOIN income AS T2 ON T1.member_id = T2.link_to_member WHERE T1.position = 'Member' AND T1.t_shirt_size = 'Medium'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 74,
    "db_id": "student_club",
    "sql_snippet": "SELECT DISTINCT event_name FROM event WHERE type =...",
    "valid": true,
    "duration_ms": 5.208253860473633,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT event_name FROM event WHERE type = 'Game' AND DATE(SUBSTR(event_date, 1, 10)) BETWEEN '2019-03-15' AND '2020-03-20' AND status = 'Closed'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.037000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 75,
    "db_id": "student_club",
    "sql_snippet": "SELECT DISTINCT T3.first_name, T3.last_name, T3.ph...",
    "valid": true,
    "duration_ms": 8.603572845458984,
    "estimated_tokens": 236,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.first_name, T3.last_name, T3.phone FROM expense AS T1 INNER JOIN budget AS T2 ON T1.link_to_budget = T2.budget_id INNER JOIN member AS T3 ON T3.member_id = T1.link_to_member WHERE T1.cost > (SELECT AVG(T1.cost) FROM expense AS T1 INNER JOIN budget AS T2 ON T1.link_to_budget = T2.budget_id INNER JOIN member AS T3 ON T3.member_id = T1.link_to_member)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.219,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 4,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 76,
    "db_id": "student_club",
    "sql_snippet": "SELECT T2.first_name, T2.last_name, T1.cost FROM e...",
    "valid": true,
    "duration_ms": 4.534482955932617,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.first_name, T2.last_name, T1.cost FROM expense AS T1 INNER JOIN member AS T2 ON T1.link_to_member = T2.member_id WHERE T1.expense_description = 'Water, Veggie tray, supplies'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 77,
    "db_id": "student_club",
    "sql_snippet": "SELECT DISTINCT T3.first_name, T3.last_name, T4.am...",
    "valid": true,
    "duration_ms": 6.755590438842773,
    "estimated_tokens": 221,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.first_name, T3.last_name, T4.amount FROM event AS T1 INNER JOIN attendance AS T2 ON T1.event_id = T2.link_to_event INNER JOIN member AS T3 ON T3.member_id = T2.link_to_member INNER JOIN income AS T4 ON T4.link_to_member = T3.member_id WHERE T4.date_received = '2019-09-09'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 78,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN Admission = '+' THEN 1 E...",
    "valid": true,
    "duration_ms": 6.554365158081055,
    "estimated_tokens": 134,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END), 0) FROM Patient WHERE SEX = 'M'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 79,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(Birthday AS...",
    "valid": true,
    "duration_ms": 7.362842559814453,
    "estimated_tokens": 140,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(Birthday AS TIMESTAMP), 'YYYY') > '1930' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(*), 0) FROM Patient WHERE SEX = 'F'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 80,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT SUM(CASE WHEN Admission = '+' THEN 1.0 ELSE...",
    "valid": true,
    "duration_ms": 5.995750427246094,
    "estimated_tokens": 126,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN Admission = '+' THEN 1.0 ELSE 0 END) / NULLIF(SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END), 0) FROM Patient WHERE Diagnosis = 'SLE'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 81,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.Diagnosis, T2.Date FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 5.297183990478516,
    "estimated_tokens": 148,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.Diagnosis, T2.Date FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID = 30609",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 82,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Pa...",
    "valid": true,
    "duration_ms": 4.605531692504883,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.LDH > 500",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 83,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, EXTRACT(YEAR FROM CURRENT_T...",
    "valid": true,
    "duration_ms": 4.541873931884766,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) AS Age FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.RVVT = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 84,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, T1.SEX, T1.Diagnosis FROM P...",
    "valid": true,
    "duration_ms": 6.669282913208008,
    "estimated_tokens": 158,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, T1.SEX, T1.Diagnosis FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T2.Thrombosis = 2",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 85,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(*) FROM Patient WHERE TO_CHAR(CAST(De...",
    "valid": true,
    "duration_ms": 4.000663757324219,
    "estimated_tokens": 130,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM Patient WHERE TO_CHAR(CAST(Description AS TIMESTAMP), 'YYYY') = '1997' AND SEX = 'F' AND Admission = '-'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.043000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 86,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(*) FROM Patient AS T1 INNER JOIN Exam...",
    "valid": true,
    "duration_ms": 6.2274932861328125,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'F' AND TO_CHAR(CAST(T2.\"Examination Date\" AS TIMESTAMP), 'YYYY') = '1997' AND T2.Thrombosis = 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 87,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T2.Symptoms, T1.Diagnosis FROM Patient AS T...",
    "valid": true,
    "duration_ms": 6.036996841430664,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Symptoms, T1.Diagnosis FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE NOT T2.Symptoms IS NULL ORDER BY T1.Birthday DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 88,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.Date, EXTRACT(YEAR FROM T2.\"First Date\")...",
    "valid": true,
    "duration_ms": 6.618976593017578,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.Date, EXTRACT(YEAR FROM T2.\"First Date\") - EXTRACT(YEAR FROM T2.Birthday) AS Age, T2.Birthday FROM Laboratory AS T1 INNER JOIN Patient AS T2 ON T1.ID = T2.ID WHERE T2.Diagnosis = 'SJS' AND T2.Birthday IS NOT NULL ORDER BY T2.Birthday ASC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 89,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.UA <= 8.0 AND T1.SEX ...",
    "valid": true,
    "duration_ms": 10.550260543823242,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.UA <= 8.0 AND T1.SEX = 'M' THEN 1 ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN T2.UA <= 6.5 AND T1.SEX = 'F' THEN 1 ELSE 0 END), 0) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.077,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 90,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 5.877256393432617,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Examination AS T2 ON T1.ID = T2.ID WHERE EXTRACT(YEAR FROM T2.\"Examination Date\") BETWEEN 1990 AND 1993 AND EXTRACT(YEAR FROM T2.\"Examination Date\") - EXTRACT(YEAR FROM T1.Birthday) < 18",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 91,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT EXTRACT(YEAR FROM T2.Date) - EXTRACT(YEAR F...",
    "valid": true,
    "duration_ms": 6.002664566040039,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT EXTRACT(YEAR FROM T2.Date) - EXTRACT(YEAR FROM T1.Birthday) AS age_difference, T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.HGB IS NOT NULL ORDER BY T2.HGB DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 92,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT \"aCL IgA\", \"aCL IgG\", \"aCL IgM\" FROM Examin...",
    "valid": true,
    "duration_ms": 4.1637420654296875,
    "estimated_tokens": 148,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT \"aCL IgA\", \"aCL IgG\", \"aCL IgM\" FROM Examination WHERE ID IN (SELECT ID FROM Patient WHERE Diagnosis = 'SLE' AND Description = '1994-02-19') AND \"Examination Date\" = '1993-11-12'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.13,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 93,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST((SUM(CASE WHEN T2.date::text LIKE '198...",
    "valid": true,
    "duration_ms": 10.001182556152344,
    "estimated_tokens": 244,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST((SUM(CASE WHEN T2.date::text LIKE '1981-11-%' THEN T2.\"T-CHO\" ELSE 0 END) - SUM(CASE WHEN T2.date::text LIKE '1981-12-%' THEN T2.\"T-CHO\" ELSE 0 END)) AS REAL) / NULLIF(SUM(CASE WHEN T2.date::text LIKE '1981-12-%' THEN T2.\"T-CHO\" ELSE 0 END), 0) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Birthday = '1959-02-18'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 94,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT ID FROM Laboratory WHERE Date BETW...",
    "valid": true,
    "duration_ms": 2.4034976959228516,
    "estimated_tokens": 143,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT ID FROM Laboratory WHERE Date BETWEEN '1987-07-06' AND '1996-01-31' AND GPT > 30 AND ALB < 4",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.037000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 95,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(*) FROM Examination WHERE Thrombosis ...",
    "valid": true,
    "duration_ms": 5.017518997192383,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM Examination WHERE Thrombosis = 2 AND \"ANA Pattern\" = 'S' AND \"aCL IgM\" > (SELECT AVG(\"aCL IgM\") * 1.2 FROM Examination WHERE Thrombosis = 2 AND \"ANA Pattern\" = 'S')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14200000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 96,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.998279571533203,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Admission = '-' AND T2.\"T-BIL\" < 2.0 AND T2.Date::text LIKE '1991-10-%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 97,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT AVG(T2.ALB) FROM Patient AS T1 INNER JOIN L...",
    "valid": true,
    "duration_ms": 5.747079849243164,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.ALB) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PLT > 400 AND T1.Diagnosis = 'SLE' AND T1.SEX = 'F'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 98,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(ID) FROM Patient WHERE SEX = 'F' AND ...",
    "valid": true,
    "duration_ms": 3.530740737915039,
    "estimated_tokens": 97,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(ID) FROM Patient WHERE SEX = 'F' AND Diagnosis = 'APS'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 99,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 ...",
    "valid": true,
    "duration_ms": 7.514715194702148,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(ID), 0) FROM Patient WHERE Diagnosis = 'RA' AND TO_CHAR(CAST(Birthday AS TIMESTAMP), 'YYYY') = '1980'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.03900000000000001,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 100,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CASE WHEN (T1.SEX = 'F' AND T2.UA > 6.5) OR...",
    "valid": true,
    "duration_ms": 6.039142608642578,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN (T1.SEX = 'F' AND T2.UA > 6.5) OR (T1.SEX = 'M' AND T2.UA > 8.0) THEN TRUE ELSE FALSE END FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID = 57266",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.082,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 101,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.984212875366211,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.SEX = 'M' AND T2.GPT >= 60",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 102,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT ON (T1.Birthday) T1.Diagnosis FROM...",
    "valid": true,
    "duration_ms": 3.9925575256347656,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT ON (T1.Birthday) T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GPT > 60 ORDER BY T1.Birthday ASC",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-DISTINCT_ON-FROM-JOIN-JOIN_INNER-WHERE-ORDER",
        "clauses_present": [
          "DISTINCT",
          "DISTINCT_ON",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 103,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Pa...",
    "valid": true,
    "duration_ms": 3.9031505584716797,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, T1.SEX, T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.UN = 29",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 104,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 3.694772720336914,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.\"T-BIL\" >= 2.0 GROUP BY T1.SEX,T1.ID",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 105,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT AVG(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRA...",
    "valid": true,
    "duration_ms": 4.50587272644043,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM T1.Birthday)) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.\"T-CHO\" >= 250 AND T1.SEX = 'M'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 106,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 5.544185638427734,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.TG >= 200 AND EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) > 50",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 107,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 5.19561767578125,
    "estimated_tokens": 187,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE TO_CHAR(CAST(T1.Birthday AS TIMESTAMP), 'YYYY') BETWEEN '1936' AND '1956' AND T1.SEX = 'M' AND T2.CPK >= 250",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 108,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, T1.SEX, EXTRACT(YEAR FROM C...",
    "valid": true,
    "duration_ms": 5.811214447021484,
    "estimated_tokens": 188,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, T1.SEX, EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) AS Age FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GLU >= 180 AND T2.\"T-CHO\" < 250",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 109,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.Diagnosis, T1.ID, EXTRACT(YEAR ...",
    "valid": true,
    "duration_ms": 5.000114440917969,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.Diagnosis, T1.ID, EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) AS Age FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RBC < 3.5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 110,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 5.709648132324219,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.ID, T1.SEX FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.Diagnosis = 'SLE' AND T2.HGB > 10 AND T2.HGB < 17 ORDER BY T1.Birthday ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 111,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID, EXTRACT(YEAR FROM CURRENT_T...",
    "valid": true,
    "duration_ms": 5.852937698364258,
    "estimated_tokens": 204,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID, EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) AS Age FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T1.ID IN (SELECT ID FROM Laboratory WHERE HCT >= 52 GROUP BY ID HAVING COUNT(ID) >= 2)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14800000000000002,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 112,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT SUM(CASE WHEN T2.PLT <= 100 THEN 1 ELSE 0 E...",
    "valid": true,
    "duration_ms": 5.63502311706543,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T2.PLT <= 100 THEN 1 ELSE 0 END) - SUM(CASE WHEN T2.PLT >= 400 THEN 1 ELSE 0 END) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 113,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 5.530834197998047,
    "estimated_tokens": 193,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.ID FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.PLT BETWEEN 100 AND 400 AND EXTRACT(YEAR FROM T2.Date) - EXTRACT(YEAR FROM T1.Birthday) < 50 AND EXTRACT(YEAR FROM T2.Date) = 1984",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 114,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.PT >= 14 AND T1.SEX =...",
    "valid": true,
    "duration_ms": 10.838985443115234,
    "estimated_tokens": 215,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.PT >= 14 AND T1.SEX = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(CASE WHEN T2.PT >= 14 THEN 1 ELSE 0 END), 0) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T1.Birthday) > 55",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 115,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 7.55620002746582,
    "estimated_tokens": 184,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.FG <= 150 OR T2.FG >= 450 AND T2.WBC > 3.5 AND T2.WBC < 9.0 AND T1.SEX = 'M'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09800000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 116,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 7.626056671142578,
    "estimated_tokens": 149,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T2.IGG >= 2000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.093,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 117,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 9.59634780883789,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE T2.IGG BETWEEN 900 AND 2000 AND NOT T3.Symptoms IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 118,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.996776580810547,
    "estimated_tokens": 160,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.IGA BETWEEN 80 AND 500 AND TO_CHAR(CAST(T1.\"First Date\" AS TIMESTAMP), 'YYYY') > '1990'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 119,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 5.551576614379883,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.Diagnosis FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE NOT T2.IGM BETWEEN 40 AND 400 GROUP BY T1.Diagnosis ORDER BY COUNT(T1.Diagnosis) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 120,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.183053970336914,
    "estimated_tokens": 135,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE (T2.CRP = '+') AND T1.Description IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 121,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 4.508256912231445,
    "estimated_tokens": 151,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CRE >= 1.5 AND EXTRACT(YEAR FROM AGE(CURRENT_DATE, T1.Birthday)) < 70",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 122,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 4.7454833984375,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.RNP = 'negative' OR T2.RNP = '0' AND T1.Admission = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 123,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Examination AS T1 INNER J...",
    "valid": true,
    "duration_ms": 3.9980411529541016,
    "estimated_tokens": 141,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Examination AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.SM IN ('negative', '0') AND T1.Thrombosis = 0",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 124,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 5.530118942260742,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T3.ID = T2.ID WHERE (T2.SC170 = 'negative' OR T2.SC170 = '0') AND T1.SEX = 'F' AND T3.Symptoms IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.123,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 125,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 IN...",
    "valid": true,
    "duration_ms": 5.646228790283203,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.CENTROMEA IN ('negative', '0') AND T2.SSB IN ('negative', '0') AND T1.SEX = 'M'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 126,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT T1.Birthday FROM Patient AS T1 INNER JOIN L...",
    "valid": true,
    "duration_ms": 4.002809524536133,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.Birthday FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID WHERE T2.GOT >= 60 ORDER BY T1.Birthday DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 127,
    "db_id": "thrombosis_prediction",
    "sql_snippet": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 5.824804306030273,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.ID) FROM Patient AS T1 INNER JOIN Laboratory AS T2 ON T1.ID = T2.ID INNER JOIN Examination AS T3 ON T1.ID = T3.ID WHERE T2.CPK < 250 AND (T3.KCT = '+' OR T3.RVVT = '+' OR T3.LAC = '+')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.123,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 128,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.name FROM Match AS t1 INNER JOIN League ...",
    "valid": true,
    "duration_ms": 6.097316741943359,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.name FROM Match AS t1 INNER JOIN League AS t2 ON t1.league_id = t2.id WHERE t1.season = '2015/2016' GROUP BY t2.name ORDER BY SUM(t1.home_team_goal + t1.away_team_goal) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 129,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT teamInfo.team_long_name FROM League AS leag...",
    "valid": true,
    "duration_ms": 10.29515266418457,
    "estimated_tokens": 238,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT teamInfo.team_long_name FROM League AS leagueData INNER JOIN Match AS matchData ON leagueData.id = matchData.league_id INNER JOIN Team AS teamInfo ON matchData.away_team_api_id = teamInfo.team_api_id WHERE leagueData.name = 'Scotland Premier League' AND matchData.season = '2009/2010' AND matchData.away_team_goal - matchData.home_team_goal > 0 GROUP BY teamInfo.team_long_name, matchData.away_team_api_id ORDER BY COUNT(*) DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.113,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 130,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.buildUpPlaySpeed FROM Team_Attributes AS...",
    "valid": true,
    "duration_ms": 2.991914749145508,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.buildUpPlaySpeed FROM Team_Attributes AS t1 INNER JOIN Team AS t2 ON t1.team_api_id = t2.team_api_id ORDER BY t1.buildUpPlaySpeed ASC NULLS FIRST LIMIT 4",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 131,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.name FROM Match AS t1 INNER JOIN League ...",
    "valid": true,
    "duration_ms": 5.510568618774414,
    "estimated_tokens": 187,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.name FROM Match AS t1 INNER JOIN League AS t2 ON t1.league_id = t2.id WHERE t1.season = '2015/2016' AND t1.home_team_goal = t1.away_team_goal GROUP BY t2.name ORDER BY COUNT(t1.id) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 132,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT EXTRACT(YEAR FROM AGE(NOW(), t2.bi...",
    "valid": true,
    "duration_ms": 9.415388107299805,
    "estimated_tokens": 244,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT EXTRACT(YEAR FROM AGE(NOW(), t2.birthday::timestamp)) + (CASE WHEN EXTRACT(MONTH FROM AGE(NOW(), t2.birthday::timestamp)) > 0 OR EXTRACT(DAY FROM AGE(NOW(), t2.birthday::timestamp)) > 0 THEN 1 ELSE 0 END) AS age FROM Player_Attributes AS t1 INNER JOIN Player AS t2 ON t1.player_api_id = t2.player_api_id WHERE EXTRACT(YEAR FROM t1.date::date) BETWEEN 2013 AND 2015 AND t1.sprint_speed >= 97",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 133,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.name, t1.max_count FROM League AS t2 JOI...",
    "valid": true,
    "duration_ms": 9.320259094238281,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.name, t1.max_count FROM League AS t2 JOIN (SELECT league_id, MAX(cnt) AS max_count FROM (SELECT league_id, COUNT(id) AS cnt FROM Match GROUP BY league_id) AS subquery GROUP BY league_id ORDER BY MAX(cnt) DESC LIMIT 1) AS t1 ON t1.league_id = t2.id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.215,
        "pattern_signature": "SELECT-FROM-JOIN-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY"
        ],
        "num_joins": 1,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 134,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT team_fifa_api_id FROM Team_Attribu...",
    "valid": true,
    "duration_ms": 3.5293102264404297,
    "estimated_tokens": 130,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT team_fifa_api_id FROM Team_Attributes WHERE buildUpPlaySpeed > 50 AND buildUpPlaySpeed < 60",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.027000000000000003,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 135,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t4.team_long_name FROM Team_Attrib...",
    "valid": true,
    "duration_ms": 10.846853256225586,
    "estimated_tokens": 276,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t4.team_long_name FROM Team_Attributes AS t3 INNER JOIN Team AS t4 ON t3.team_api_id = t4.team_api_id WHERE SUBSTR(t3.\"date\", 1, 4) = '2012' AND t3.buildUpPlayPassing > (SELECT CAST(SUM(t2.buildUpPlayPassing) AS REAL) / NULLIF(COUNT(t1.id), 0) FROM Team AS t1 INNER JOIN Team_Attributes AS t2 ON t1.team_api_id = t2.team_api_id WHERE TO_CHAR(CAST(t2.\"date\" AS TIMESTAMP), 'YYYY') = '2012')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.18200000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 136,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN t2.preferred_foot = 'l...",
    "valid": true,
    "duration_ms": 7.5931549072265625,
    "estimated_tokens": 200,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN t2.preferred_foot = 'left' THEN t1.id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(t1.id), 0) AS percent FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE SUBSTR(t1.birthday, 1, 4) BETWEEN '1987' AND '1992'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 137,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(t2.long_shots) AS REAL) / NULLIF(C...",
    "valid": true,
    "duration_ms": 5.588293075561523,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(t2.long_shots) AS REAL) / NULLIF(COUNT(t2.\"date\"), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.player_name = 'Ahmed Samir Farag'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 138,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.player_name FROM Player AS t1 INNER JOIN...",
    "valid": true,
    "duration_ms": 7.695913314819336,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.height > 180 GROUP BY t1.id ORDER BY CAST(SUM(t2.heading_accuracy) AS REAL) / NULLIF(COUNT(t2.\"player_fifa_api_id\"), 0) DESC NULLS LAST LIMIT 10",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 139,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.name FROM League AS t1 INNER JOIN Match ...",
    "valid": true,
    "duration_ms": 10.629892349243164,
    "estimated_tokens": 222,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.name FROM League AS t1 INNER JOIN Match AS t2 ON t1.id = t2.league_id WHERE t2.season = '2009/2010' GROUP BY t1.name HAVING (CAST(SUM(t2.home_team_goal) AS REAL) / NULLIF(COUNT(DISTINCT t2.id), 0)) - (CAST(SUM(t2.away_team_goal) AS REAL) / NULLIF(COUNT(DISTINCT t2.id), 0)) > 0",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.083,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 4
      }
    }
  },
  {
    "query_idx": 140,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT player_name FROM Player WHERE SUBSTR(birthd...",
    "valid": true,
    "duration_ms": 4.67371940612793,
    "estimated_tokens": 106,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT player_name FROM Player WHERE SUBSTR(birthday, 1, 7) = '1970-10'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 141,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.overall_rating FROM Player AS t1 INNER J...",
    "valid": true,
    "duration_ms": 5.551338195800781,
    "estimated_tokens": 181,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.overall_rating FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.player_name = 'Gabriel Tamas' AND TO_CHAR(CAST(t2.date AS TIMESTAMP), 'YYYY') = '2011'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 142,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(t2.home_team_goal) AS REAL) / NULL...",
    "valid": true,
    "duration_ms": 6.7729949951171875,
    "estimated_tokens": 184,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(t2.home_team_goal) AS REAL) / NULLIF(COUNT(t2.id), 0) FROM Country AS t1 INNER JOIN Match AS t2 ON t1.id = t2.country_id WHERE t1.name = 'Poland' AND t2.season = '2010/2011'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 143,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT A FROM (SELECT AVG(finishing) AS result, 'M...",
    "valid": true,
    "duration_ms": 13.132333755493164,
    "estimated_tokens": 255,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT A FROM (SELECT AVG(finishing) AS result, 'Max' AS A FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T1.height = (SELECT MAX(height) FROM Player) UNION SELECT AVG(finishing) AS result, 'Min' AS A FROM Player AS T1 INNER JOIN Player_Attributes AS T2 ON T1.player_api_id = T2.player_api_id WHERE T1.height = (SELECT MIN(height) FROM Player)) AS subquery ORDER BY result DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.29200000000000004,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-UNION-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "UNION",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 3,
        "num_ctes": 0,
        "num_aggregations": 4
      }
    }
  },
  {
    "query_idx": 144,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULL...",
    "valid": true,
    "duration_ms": 7.133722305297852,
    "estimated_tokens": 212,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULLIF(COUNT(t2.id), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.height > 170 AND TO_CHAR(CAST(t2.\"date\" AS TIMESTAMP), 'YYYY') >= '2010' AND TO_CHAR(CAST(t2.\"date\" AS TIMESTAMP), 'YYYY') <= '2015'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.084,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 145,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN t1.player_name = 'Abdou ...",
    "valid": true,
    "duration_ms": 14.228343963623047,
    "estimated_tokens": 253,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN t1.player_name = 'Abdou Diallo' THEN t2.ball_control ELSE 0 END) AS REAL) / NULLIF(COUNT(CASE WHEN t1.player_name = 'Abdou Diallo' THEN t2.id ELSE NULL END), 0) - CAST(SUM(CASE WHEN t1.player_name = 'Aaron Appindangoye' THEN t2.ball_control ELSE 0 END) AS REAL) / NULLIF(COUNT(CASE WHEN t1.player_name = 'Aaron Appindangoye' THEN t2.id ELSE NULL END), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.069,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 4
      }
    }
  },
  {
    "query_idx": 146,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT player_name FROM Player WHERE player_name I...",
    "valid": true,
    "duration_ms": 3.013134002685547,
    "estimated_tokens": 118,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT player_name FROM Player WHERE player_name IN ('Aaron Lennon', 'Abdelaziz Barrada') ORDER BY birthday ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 147,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT player_name FROM Player ORDER BY height DES...",
    "valid": true,
    "duration_ms": 1.619577407836914,
    "estimated_tokens": 113,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT player_name FROM Player ORDER BY height DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.010000000000000002,
        "pattern_signature": "SELECT-FROM-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 148,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT COUNT(player_api_id) FROM Player_Attributes...",
    "valid": true,
    "duration_ms": 1.9752979278564453,
    "estimated_tokens": 109,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(player_api_id) FROM Player_Attributes WHERE preferred_foot = 'left' AND attacking_work_rate = 'low'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 149,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT COUNT(DISTINCT t1.player_name) FROM Player ...",
    "valid": true,
    "duration_ms": 5.03230094909668,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT t1.player_name) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE TO_CHAR(CAST(t1.birthday AS TIMESTAMP), 'YYYY') < '1986' AND t2.defensive_work_rate = 'high'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 150,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.player_name FROM Player AS t1 I...",
    "valid": true,
    "duration_ms": 4.137516021728516,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t2.volleys > 70 AND t2.dribbling > 70",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 151,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT COUNT(t2.id) FROM League AS t1 INNER JOIN M...",
    "valid": true,
    "duration_ms": 3.6869049072265625,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(t2.id) FROM League AS t1 INNER JOIN Match AS t2 ON t1.id = t2.league_id WHERE t1.name = 'Belgium Jupiler League' AND SUBSTR(t2.\"date\", 1, 7) = '2009-04'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 152,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.name FROM League AS t1 JOIN Match AS t2 ...",
    "valid": true,
    "duration_ms": 7.381677627563477,
    "estimated_tokens": 228,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.name FROM League AS t1 JOIN Match AS t2 ON t1.id = t2.league_id WHERE t2.season = '2008/2009' GROUP BY t1.name HAVING COUNT(t2.id) = (SELECT MAX(match_count) FROM (SELECT COUNT(t2.id) AS match_count FROM Match AS t2 WHERE t2.season = '2008/2009' GROUP BY t2.league_id) AS subquery)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.23600000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-WHERE-GROUP-HAVING-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 153,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT (SUM(CASE WHEN t1.player_name = 'Ariel Bory...",
    "valid": true,
    "duration_ms": 10.843753814697266,
    "estimated_tokens": 225,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (SUM(CASE WHEN t1.player_name = 'Ariel Borysiuk' THEN t2.overall_rating ELSE 0 END) * 1.0 - SUM(CASE WHEN t1.player_name = 'Paulin Puel' THEN t2.overall_rating ELSE 0 END)) * 100 / NULLIF(SUM(CASE WHEN t1.player_name = 'Paulin Puel' THEN t2.overall_rating ELSE 0 END), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.063,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 154,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULL...",
    "valid": true,
    "duration_ms": 5.149126052856445,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULLIF(COUNT(t2.id), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.player_name = 'Pietro Marino'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 155,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.chanceCreationPassing, t2.chanceCreation...",
    "valid": true,
    "duration_ms": 4.618406295776367,
    "estimated_tokens": 187,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.chanceCreationPassing, t2.chanceCreationPassingClass FROM Team AS t1 INNER JOIN Team_Attributes AS t2 ON t1.team_api_id = t2.team_api_id WHERE t1.team_long_name = 'Ajax' ORDER BY t2.chanceCreationPassing DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 156,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.player_name FROM Player AS t1 INNER JOIN...",
    "valid": true,
    "duration_ms": 7.000207901000977,
    "estimated_tokens": 204,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE SUBSTR(t2.\"date\", 1, 10) = '2016-06-23' AND t2.overall_rating = 77 ORDER BY t1.birthday ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 157,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.overall_rating FROM Player AS t1 INNER J...",
    "valid": true,
    "duration_ms": 5.054950714111328,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.overall_rating FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE SUBSTR(t2.\"date\", 1, 10) = '2016-02-04' AND t1.player_name = 'Aaron Mooy'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 158,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.attacking_work_rate FROM Player AS t1 IN...",
    "valid": true,
    "duration_ms": 3.998994827270508,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.attacking_work_rate FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t2.\"date\" LIKE '2015-05-01%' AND t1.player_name = 'Francesco Migliore'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 159,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT \"date\" FROM (SELECT t2.crossing, t2.\"date\" ...",
    "valid": true,
    "duration_ms": 6.236076354980469,
    "estimated_tokens": 188,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT \"date\" FROM (SELECT t2.crossing, t2.\"date\" FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_fifa_api_id = t2.player_fifa_api_id WHERE t1.player_name = 'Kevin Constant' ORDER BY t2.crossing DESC) AS subquery ORDER BY \"date\" DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.128,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 160,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.buildUpPlayPassingClass FROM Team AS t1 ...",
    "valid": true,
    "duration_ms": 4.078388214111328,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.buildUpPlayPassingClass FROM Team AS t1 INNER JOIN Team_Attributes AS t2 ON t1.team_api_id = t2.team_api_id WHERE t1.team_long_name = 'FC Lorient' AND t2.\"date\" LIKE '2010-02-22%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 161,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.defenceAggressionClass FROM Team AS t1 I...",
    "valid": true,
    "duration_ms": 4.025936126708984,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.defenceAggressionClass FROM Team AS t1 INNER JOIN Team_Attributes AS t2 ON t1.team_api_id = t2.team_api_id WHERE t1.team_long_name = 'Hannover 96' AND t2.\"date\" LIKE '2015-09-10%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 162,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULL...",
    "valid": true,
    "duration_ms": 8.504390716552734,
    "estimated_tokens": 225,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(t2.overall_rating) AS REAL) / NULLIF(COUNT(t2.id), 0) FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_fifa_api_id = t2.player_fifa_api_id WHERE t1.player_name = 'Marko Arnautovic' AND SUBSTR(t2.\"date\", 1, 10) BETWEEN '2007-02-22' AND '2016-04-21'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 163,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT (SUM(CASE WHEN t1.player_name = 'Landon Don...",
    "valid": true,
    "duration_ms": 15.274763107299805,
    "estimated_tokens": 263,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (SUM(CASE WHEN t1.player_name = 'Landon Donovan' THEN t2.overall_rating ELSE 0 END) * 1.0 - SUM(CASE WHEN t1.player_name = 'Jordan Bowery' THEN t2.overall_rating ELSE 0 END)) * 100 / NULLIF(SUM(CASE WHEN t1.player_name = 'Landon Donovan' THEN t2.overall_rating ELSE 0 END), 0) AS LvsJ_percent FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_fifa_api_id = t2.player_fifa_api_id WHERE SUBSTR(t2.\"date\", 1, 10) = '2013-07-12'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 164,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT player_name FROM (SELECT player_name, heigh...",
    "valid": true,
    "duration_ms": 4.002571105957031,
    "estimated_tokens": 144,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT player_name FROM (SELECT player_name, height, DENSE_RANK() OVER (ORDER BY height DESC) AS rank FROM Player) AS subquery WHERE rank = 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09900000000000003,
        "pattern_signature": "SELECT-FROM-WHERE-WINDOW-ORDER-SUBQUERY",
        "clauses_present": [
          "FROM",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE",
          "WINDOW"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 165,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.player_name FROM Player AS t1 I...",
    "valid": true,
    "duration_ms": 6.297826766967773,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t2.overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.134,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 166,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.player_name FROM Player AS t1 I...",
    "valid": true,
    "duration_ms": 4.044532775878906,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t2.attacking_work_rate = 'high'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 167,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.team_short_name FROM Team AS t1...",
    "valid": true,
    "duration_ms": 3.998279571533203,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.team_short_name FROM Team AS t1 INNER JOIN Team_Attributes AS t2 ON t1.team_api_id = t2.team_api_id WHERE t2.chanceCreationPassingClass = 'Safe'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 168,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT COUNT(id) FROM Player WHERE birthday > '199...",
    "valid": true,
    "duration_ms": 3.568887710571289,
    "estimated_tokens": 102,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(id) FROM Player WHERE birthday > '1990' AND player_name LIKE 'Aaron%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 169,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT SUM(CASE WHEN t1.id = 6 THEN t1.jumping ELS...",
    "valid": true,
    "duration_ms": 5.99980354309082,
    "estimated_tokens": 141,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN t1.id = 6 THEN t1.jumping ELSE 0 END) - SUM(CASE WHEN t1.id = 23 THEN t1.jumping ELSE 0 END) FROM Player_Attributes AS t1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 170,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT id FROM Player_Attributes WHERE preferred_f...",
    "valid": true,
    "duration_ms": 4.630565643310547,
    "estimated_tokens": 110,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id FROM Player_Attributes WHERE preferred_foot = 'right' ORDER BY potential ASC NULLS LAST LIMIT 4",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 171,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT COUNT(t1.id) FROM Player_Attributes AS t1 W...",
    "valid": true,
    "duration_ms": 5.896329879760742,
    "estimated_tokens": 141,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(t1.id) FROM Player_Attributes AS t1 WHERE t1.preferred_foot = 'left' AND t1.crossing = (SELECT MAX(crossing) FROM Player_Attributes)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.11500000000000003,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 172,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.home_team_goal, t2.away_team_goal FROM L...",
    "valid": true,
    "duration_ms": 5.62286376953125,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.home_team_goal, t2.away_team_goal FROM League AS t1 INNER JOIN Match AS t2 ON t1.id = t2.league_id WHERE t1.name = 'Belgium Jupiler League' AND t2.\"date\" LIKE '2008-09-24%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 173,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.buildUpPlaySpeedClass FROM Team...",
    "valid": true,
    "duration_ms": 4.562616348266602,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.buildUpPlaySpeedClass FROM Team_Attributes AS t1 INNER JOIN Team AS t2 ON t1.team_api_id = t2.team_api_id WHERE t2.team_long_name = 'KSV Cercle Brugge'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 174,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT id, finishing, curve FROM Player_Attributes...",
    "valid": true,
    "duration_ms": 4.513978958129883,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id, finishing, curve FROM Player_Attributes WHERE player_api_id = (SELECT player_api_id FROM Player ORDER BY weight DESC NULLS LAST LIMIT 1) LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 175,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t1.name FROM League AS t1 INNER JOIN Match ...",
    "valid": true,
    "duration_ms": 4.732370376586914,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t1.name FROM League AS t1 INNER JOIN Match AS t2 ON t1.id = t2.league_id WHERE t2.season = '2015/2016' GROUP BY t1.name ORDER BY COUNT(t2.id) DESC NULLS LAST LIMIT 4",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 176,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT t2.team_long_name FROM Match AS t1 INNER JO...",
    "valid": true,
    "duration_ms": 4.499912261962891,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT t2.team_long_name FROM Match AS t1 INNER JOIN Team AS t2 ON t1.away_team_api_id = t2.team_api_id ORDER BY t1.away_team_goal DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 177,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT DISTINCT t1.player_name FROM Player AS t1 I...",
    "valid": true,
    "duration_ms": 4.0149688720703125,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT t1.player_name FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t2.overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.134,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 178,
    "db_id": "european_football_2",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN t2.overall_rating > 70...",
    "valid": true,
    "duration_ms": 8.637428283691406,
    "estimated_tokens": 177,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN t2.overall_rating > 70 AND t1.height < 180 THEN t1.id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(t1.id), 0) AS percent FROM Player AS t1 INNER JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.067,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 179,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.driverRef FROM qualifying AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 4.2667388916015625,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.driverRef FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 20 ORDER BY T1.q1 DESC NULLS LAST LIMIT 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 180,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.surname FROM qualifying AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 5.180835723876953,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.surname FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 19 ORDER BY T1.q2 ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 181,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T2.name FROM circuits AS T1 INNER ...",
    "valid": true,
    "duration_ms": 3.9827823638916016,
    "estimated_tokens": 149,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.name FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T1.country = 'Germany'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 182,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1...",
    "valid": true,
    "duration_ms": 3.5104751586914062,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T2.name = 'Australian Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 183,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1...",
    "valid": true,
    "duration_ms": 3.5440921783447266,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T2.name = 'Abu Dhabi Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 184,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.q1 FROM qualifying AS T1 INNER JOIN driv...",
    "valid": true,
    "duration_ms": 4.0130615234375,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.q1 FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 354 AND T2.forename = 'Bruno' AND T2.surname = 'Senna'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 185,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.number FROM qualifying AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 3.0319690704345703,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.number FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 903 AND T1.q3 LIKE '1:54%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 186,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(T3.driverId) FROM races AS T1 INNER J...",
    "valid": true,
    "duration_ms": 6.548166275024414,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T3.driverId) FROM races AS T1 INNER JOIN results AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T1.year = 2007 AND T1.name = 'Bahrain Grand Prix' AND T2.time IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.113,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 187,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.forename, T1.surname FROM drivers AS T1 ...",
    "valid": true,
    "duration_ms": 5.766153335571289,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.forename, T1.surname FROM drivers AS T1 INNER JOIN results AS T2 ON T2.driverId = T1.driverId WHERE T2.raceId = 592 AND NOT T2.time IS NULL AND NOT T1.dob IS NULL ORDER BY T1.dob ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 188,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T2.forename, T2.surname, T2.url FR...",
    "valid": true,
    "duration_ms": 4.648923873901367,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.forename, T2.surname, T2.url FROM lapTimes AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 161 AND T1.time LIKE '1:27%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 189,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1...",
    "valid": true,
    "duration_ms": 1.992940902709961,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.lat, T1.lng FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T2.name = 'Malaysian Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 190,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.url FROM constructorResults AS T1 INNER ...",
    "valid": true,
    "duration_ms": 3.9815902709960938,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.url FROM constructorResults AS T1 INNER JOIN constructors AS T2 ON T2.constructorId = T1.constructorId WHERE T1.raceId = 9 ORDER BY T1.points DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 191,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.code FROM qualifying AS T1 INNER JOIN dr...",
    "valid": true,
    "duration_ms": 4.096031188964844,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.code FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T2.driverId = T1.driverId WHERE T1.raceId = 45 AND T1.q3 LIKE '1:33%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 192,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.url FROM races AS T1 INNER JOIN seasons ...",
    "valid": true,
    "duration_ms": 2.5539398193359375,
    "estimated_tokens": 142,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.url FROM races AS T1 INNER JOIN seasons AS T2 ON T2.year = T1.year WHERE T1.raceId = 901",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 193,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.forename, T1.surname FROM drivers AS T1 ...",
    "valid": true,
    "duration_ms": 4.003286361694336,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.forename, T1.surname FROM drivers AS T1 INNER JOIN results AS T2 ON T2.driverId = T1.driverId WHERE T2.raceId = 872 AND NOT T2.time IS NULL ORDER BY T1.dob DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 194,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.nationality FROM drivers AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.0062198638916016,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.nationality FROM drivers AS T1 INNER JOIN results AS T2 ON T2.driverId = T1.driverId ORDER BY CAST(T2.fastestLapSpeed AS DOUBLE PRECISION) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 195,
    "db_id": "formula_1",
    "sql_snippet": "SELECT (SUM(CASE WHEN T2.raceId = 853 THEN T2.fast...",
    "valid": true,
    "duration_ms": 9.659528732299805,
    "estimated_tokens": 234,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (SUM(CASE WHEN T2.raceId = 853 THEN T2.fastestLapSpeed::numeric ELSE 0 END) - SUM(CASE WHEN T2.raceId = 854 THEN T2.fastestLapSpeed::numeric ELSE 0 END)) * 100 / NULLIF(SUM(CASE WHEN T2.raceId = 853 THEN T2.fastestLapSpeed::numeric ELSE 0 END), 0) FROM drivers AS T1 INNER JOIN results AS T2 ON T2.driverId = T1.driverId WHERE T1.forename = 'Paul' AND T1.surname = 'di Resta'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 196,
    "db_id": "formula_1",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN NOT T2.time IS NULL TH...",
    "valid": true,
    "duration_ms": 5.00035285949707,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN NOT T2.time IS NULL THEN T2.driverId END) AS REAL) * 100 / NULLIF(COUNT(T2.driverId), 0) FROM races AS T1 INNER JOIN results AS T2 ON T2.raceId = T1.raceId WHERE T1.date = '1983-07-16'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 197,
    "db_id": "formula_1",
    "sql_snippet": "SELECT name FROM races WHERE TO_CHAR(CAST(date AS ...",
    "valid": true,
    "duration_ms": 6.046772003173828,
    "estimated_tokens": 200,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT name FROM races WHERE TO_CHAR(CAST(date AS TIMESTAMP), 'YYYY') = (SELECT TO_CHAR(CAST(date AS TIMESTAMP), 'YYYY') FROM races ORDER BY date ASC NULLS FIRST LIMIT 1) AND TO_CHAR(CAST(date AS TIMESTAMP), 'MM') = (SELECT TO_CHAR(CAST(date AS TIMESTAMP), 'MM') FROM races ORDER BY date ASC NULLS FIRST LIMIT 1)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.13500000000000004,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 198,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T3.forename, T3.surname, T2.points FROM rac...",
    "valid": true,
    "duration_ms": 3.999948501586914,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.forename, T3.surname, T2.points FROM races AS T1 INNER JOIN driverStandings AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId ORDER BY T2.points DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 199,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.milliseconds, T1.forename, T1.surname, T...",
    "valid": true,
    "duration_ms": 5.1422119140625,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.milliseconds, T1.forename, T1.surname, T3.name FROM drivers AS T1 INNER JOIN lapTimes AS T2 ON T1.driverId = T2.driverId INNER JOIN races AS T3 ON T2.raceId = T3.raceId ORDER BY T2.milliseconds ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 200,
    "db_id": "formula_1",
    "sql_snippet": "SELECT AVG(T2.milliseconds) FROM races AS T1 INNER...",
    "valid": true,
    "duration_ms": 5.045175552368164,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.milliseconds) FROM races AS T1 INNER JOIN lapTimes AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.forename = 'Lewis' AND T3.surname = 'Hamilton' AND T1.year = 2009 AND T1.name = 'Malaysian Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.123,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 201,
    "db_id": "formula_1",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T2.position <> 1 THEN ...",
    "valid": true,
    "duration_ms": 8.513212203979492,
    "estimated_tokens": 199,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T2.position <> 1 THEN T2.position END) AS REAL) * 100 / NULLIF(COUNT(T2.driverStandingsId), 0) FROM races AS T1 INNER JOIN driverStandings AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.surname = 'Hamilton' AND T1.year >= 2010",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.109,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 202,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.forename, T1.surname, T1.nationality, MA...",
    "valid": true,
    "duration_ms": 7.014274597167969,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.forename, T1.surname, T1.nationality, MAX(T2.points) FROM drivers AS T1 INNER JOIN driverStandings AS T2 ON T2.driverId = T1.driverId WHERE T2.wins >= 1 GROUP BY T1.forename, T1.surname, T1.nationality ORDER BY COUNT(T2.wins) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 203,
    "db_id": "formula_1",
    "sql_snippet": "SELECT EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTR...",
    "valid": true,
    "duration_ms": 3.7033557891845703,
    "estimated_tokens": 124,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM dob) AS age, forename, surname FROM drivers WHERE nationality = 'Japanese' ORDER BY dob DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 204,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT T2.name, T1.name, T1.location FROM...",
    "valid": true,
    "duration_ms": 5.166769027709961,
    "estimated_tokens": 184,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.name, T1.name, T1.location FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T2.year = 2005 AND TO_CHAR(CAST(T2.date AS TIMESTAMP), 'MM') = '09'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 205,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.name FROM races AS T1 INNER JOIN driverS...",
    "valid": true,
    "duration_ms": 6.367683410644531,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.name FROM races AS T1 INNER JOIN driverStandings AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.forename = 'Alex' AND T3.surname = 'Yoong' AND T2.position < 20",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.107,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 206,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.name, T1.year FROM races AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 4.63557243347168,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.name, T1.year FROM races AS T1 INNER JOIN lapTimes AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.forename = 'Michael' AND T3.surname = 'Schumacher' ORDER BY T2.milliseconds ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 207,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.name, T2.points FROM races AS T1 INNER J...",
    "valid": true,
    "duration_ms": 4.5261383056640625,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.name, T2.points FROM races AS T1 INNER JOIN driverStandings AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.forename = 'Lewis' AND T3.surname = 'Hamilton' ORDER BY T1.year ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 208,
    "db_id": "formula_1",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T1.country = 'Germany'...",
    "valid": true,
    "duration_ms": 5.199909210205078,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T1.country = 'Germany' THEN T2.circuitID END) AS REAL) * 100 / NULLIF(COUNT(T2.circuitId), 0) FROM circuits AS T1 INNER JOIN races AS T2 ON T2.circuitID = T1.circuitId WHERE T2.name = 'European Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 209,
    "db_id": "formula_1",
    "sql_snippet": "SELECT lat, lng FROM circuits WHERE name = 'Silver...",
    "valid": true,
    "duration_ms": 2.0008087158203125,
    "estimated_tokens": 92,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT lat, lng FROM circuits WHERE name = 'Silverstone Circuit'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 210,
    "db_id": "formula_1",
    "sql_snippet": "SELECT circuitRef FROM circuits WHERE name = 'Mari...",
    "valid": true,
    "duration_ms": 1.9931793212890625,
    "estimated_tokens": 92,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT circuitRef FROM circuits WHERE name = 'Marina Bay Street Circuit'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 211,
    "db_id": "formula_1",
    "sql_snippet": "SELECT nationality FROM drivers WHERE NOT dob IS N...",
    "valid": true,
    "duration_ms": 2.5238990783691406,
    "estimated_tokens": 105,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT nationality FROM drivers WHERE NOT dob IS NULL ORDER BY dob ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 212,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T3.forename, T3.surname, T3.driverRef FROM ...",
    "valid": true,
    "duration_ms": 7.684469223022461,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.forename, T3.surname, T3.driverRef FROM races AS T1 INNER JOIN results AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T1.name = 'Canadian Grand Prix' AND T2.rank = 1 AND T1.year = 2007",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.107,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 213,
    "db_id": "formula_1",
    "sql_snippet": "SELECT name FROM races WHERE raceId IN (SELECT rac...",
    "valid": true,
    "duration_ms": 3.999948501586914,
    "estimated_tokens": 140,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT name FROM races WHERE raceId IN (SELECT raceId FROM results WHERE rank = 1 AND driverId = (SELECT driverId FROM drivers WHERE forename = 'Lewis' AND surname = 'Hamilton'))",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.22300000000000003,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 214,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.fastestLapSpeed FROM races AS T1 INNER J...",
    "valid": true,
    "duration_ms": 3.5076141357421875,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.fastestLapSpeed FROM races AS T1 INNER JOIN results AS T2 ON T2.raceId = T1.raceId WHERE T1.name = 'Spanish Grand Prix' AND T1.year = 2009 AND NOT T2.fastestLapSpeed IS NULL ORDER BY T2.fastestLapSpeed DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 215,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.positionOrder FROM races AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 5.65028190612793,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.positionOrder FROM races AS T1 INNER JOIN results AS T2 ON T2.raceId = T1.raceId INNER JOIN drivers AS T3 ON T3.driverId = T2.driverId WHERE T3.forename = 'Lewis' AND T3.surname = 'Hamilton' AND T1.name = 'Chinese Grand Prix' AND T1.year = 2008",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.11699999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 216,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.time FROM results AS T1 INNER JOIN races...",
    "valid": true,
    "duration_ms": 3.995180130004883,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.time FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T1.rank = 2 AND T2.name = 'Chinese Grand Prix' AND T2.year = 2008",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 217,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(*) FROM (SELECT T1.driverId FROM resu...",
    "valid": true,
    "duration_ms": 5.523681640625,
    "estimated_tokens": 207,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM (SELECT T1.driverId FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.name = 'Chinese Grand Prix' AND T2.year = 2008 AND T1.time IS NOT NULL GROUP BY T1.driverId HAVING COUNT(T2.raceId) > 0) AS subquery",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.16700000000000004,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 218,
    "db_id": "formula_1",
    "sql_snippet": "WITH time_in_seconds AS (SELECT T1.positionOrder, ...",
    "valid": true,
    "duration_ms": 16.600608825683594,
    "estimated_tokens": 389,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH time_in_seconds AS (SELECT T1.positionOrder, CASE WHEN T1.positionOrder = 1 THEN (CAST(SUBSTR(T1.time, 1, 1) AS REAL) * 3600) + (CAST(SUBSTR(T1.time, 3, 2) AS REAL) * 60) + CAST(SUBSTR(T1.time, 6) AS REAL) ELSE CAST(SUBSTR(T1.time, 2) AS REAL) END AS time_seconds FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.name = 'Australian Grand Prix' AND NOT T1.time IS NULL AND T2.year = 2008), champion_time AS (SELECT time_seconds FROM time_in_seconds WHERE positionOrder = 1), last_driver_incremental AS (SELECT time_seconds FROM time_in_seconds WHERE positionOrder = (SELECT MAX(positionOrder) FROM time_in_seconds)) SELECT (CAST((SELECT time_seconds FROM last_driver_incremental) AS REAL) * 100) / NULLIF((SELECT time_seconds + (SELECT time_seconds FROM last_driver_incremental) FROM champion_time), 0)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.338,
        "pattern_signature": "WITH-CTE-SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "CTE",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE",
          "WITH"
        ],
        "num_joins": 1,
        "num_subqueries": 4,
        "num_ctes": 3,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 219,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(circuitId) FROM circuits WHERE locati...",
    "valid": true,
    "duration_ms": 3.019094467163086,
    "estimated_tokens": 98,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(circuitId) FROM circuits WHERE location = 'Adelaide' AND country = 'Australia'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 220,
    "db_id": "formula_1",
    "sql_snippet": "SELECT MAX(T1.points) FROM constructorStandings AS...",
    "valid": true,
    "duration_ms": 2.9821395874023438,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT MAX(T1.points) FROM constructorStandings AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId WHERE T2.nationality = 'British'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 221,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.name FROM constructorStandings AS T1 INN...",
    "valid": true,
    "duration_ms": 3.0002593994140625,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.name FROM constructorStandings AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId WHERE T1.points = 0 AND T1.raceId = 291",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 222,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(T1.raceId) FROM constructorStandings ...",
    "valid": true,
    "duration_ms": 4.82487678527832,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.raceId) FROM constructorStandings AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId WHERE T1.points = 0 AND T2.nationality = 'Japanese' GROUP BY T1.constructorId HAVING COUNT(raceId) = 2",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.081,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 223,
    "db_id": "formula_1",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN NOT T1.time IS NULL THEN...",
    "valid": true,
    "duration_ms": 5.975961685180664,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN NOT T1.time IS NULL THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.raceId), 0) FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN drivers AS T3 ON T1.driverId = T3.driverId WHERE T3.nationality = 'Japanese' AND T2.year BETWEEN 2007 AND 2009",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.109,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 224,
    "db_id": "formula_1",
    "sql_snippet": "WITH time_in_seconds AS (SELECT T2.year, T2.raceId...",
    "valid": true,
    "duration_ms": 19.773483276367188,
    "estimated_tokens": 487,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH time_in_seconds AS (SELECT T2.year, T2.raceId, T1.positionOrder, CASE WHEN T1.positionOrder = 1 THEN (CASE WHEN SPLIT_PART(T1.time, ':', 1) <> '' AND SPLIT_PART(T1.time, ':', 2) <> '' AND SPLIT_PART(SPLIT_PART(T1.time, ':', 3), '.', 1) <> '' THEN (CAST(SPLIT_PART(T1.time, ':', 1) AS REAL) * 3600) + (CAST(SPLIT_PART(T1.time, ':', 2) AS REAL) * 60) + CAST(SPLIT_PART(SPLIT_PART(T1.time, ':', 3), '.', 1) AS REAL) + CAST(SPLIT_PART(SPLIT_PART(T1.time, ':', 3), '.', 2) AS REAL)/1000   ELSE 0 END) ELSE (CASE WHEN SUBSTRING(T1.time FROM 2) <> '' THEN CAST(SUBSTRING(T1.time FROM 2) AS REAL) ELSE 0 END) END AS time_seconds FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T1.time IS NOT NULL AND T1.time != ''), champion_time AS (SELECT year, raceId, time_seconds FROM time_in_seconds WHERE positionOrder = 1)  SELECT year, AVG(time_seconds) FROM champion_time WHERE year < 1975 GROUP BY year HAVING AVG(time_seconds) IS NOT NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.17900000000000002,
        "pattern_signature": "WITH-CTE-SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "CTE",
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE",
          "WITH"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 2,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 225,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.fastestLap FROM results AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 4.027605056762695,
    "estimated_tokens": 158,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.fastestLap FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.year = 2009 AND T1.time LIKE '_:%:__.___'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 226,
    "db_id": "formula_1",
    "sql_snippet": "SELECT AVG(CAST(T1.fastestLapSpeed AS NUMERIC)) FR...",
    "valid": true,
    "duration_ms": 3.988027572631836,
    "estimated_tokens": 151,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(CAST(T1.fastestLapSpeed AS NUMERIC)) FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.year = 2009 AND T2.name = 'Spanish Grand Prix'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 227,
    "db_id": "formula_1",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(T3.dob AS T...",
    "valid": true,
    "duration_ms": 6.999492645263672,
    "estimated_tokens": 214,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(T3.dob AS TIMESTAMP), 'YYYY') < '1985' AND T1.laps > 50 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(*), 0) FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN drivers AS T3 ON T1.driverId = T3.driverId WHERE T2.year BETWEEN 2000 AND 2005",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.109,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 228,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(T1.driverId) FROM drivers AS T1 INNER...",
    "valid": true,
    "duration_ms": 3.7496089935302734,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.driverId) FROM drivers AS T1 INNER JOIN lapTimes AS T2 ON T1.driverId = T2.driverId WHERE T1.nationality = 'French' AND (EXTRACT(MINUTE FROM T2.time::INTERVAL) * 60 + EXTRACT(SECOND FROM T2.time::INTERVAL)) < 120",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 229,
    "db_id": "formula_1",
    "sql_snippet": "SELECT code FROM drivers WHERE Nationality = 'Amer...",
    "valid": true,
    "duration_ms": 2.0101070404052734,
    "estimated_tokens": 88,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT code FROM drivers WHERE Nationality = 'American'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 230,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(*) FROM (SELECT nationality FROM driv...",
    "valid": true,
    "duration_ms": 2.9833316802978516,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM (SELECT nationality FROM drivers ORDER BY dob DESC LIMIT 3) AS T3 WHERE nationality = 'Dutch'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09900000000000003,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 231,
    "db_id": "formula_1",
    "sql_snippet": "SELECT driverRef FROM drivers WHERE nationality = ...",
    "valid": true,
    "duration_ms": 1.9893646240234375,
    "estimated_tokens": 104,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT driverRef FROM drivers WHERE nationality = 'German' ORDER BY dob ASC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 232,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.driverId, T2.code FROM results AS T1 INN...",
    "valid": true,
    "duration_ms": 4.235744476318359,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.driverId, T2.code FROM results AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId WHERE TO_CHAR(CAST(T2.dob AS TIMESTAMP), 'YYYY') = '1971' AND NOT T1.fastestLapTime IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 233,
    "db_id": "formula_1",
    "sql_snippet": "SELECT SUM(CASE WHEN NOT time IS NULL THEN 1 ELSE ...",
    "valid": true,
    "duration_ms": 4.044055938720703,
    "estimated_tokens": 133,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN NOT time IS NULL THEN 1 ELSE 0 END) FROM results WHERE statusId = 2 AND raceID < 100 AND raceId > 50",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.043000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 234,
    "db_id": "formula_1",
    "sql_snippet": "SELECT DISTINCT location, lat, lng FROM circuits W...",
    "valid": true,
    "duration_ms": 2.0287036895751953,
    "estimated_tokens": 99,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT location, lat, lng FROM circuits WHERE country = 'Austria'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 235,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T3.year, T3.name, T3.date, T3.time FROM qua...",
    "valid": true,
    "duration_ms": 5.627155303955078,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.year, T3.name, T3.date, T3.time FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId INNER JOIN races AS T3 ON T1.raceId = T3.raceId WHERE T1.driverId = (SELECT driverId FROM drivers ORDER BY dob DESC NULLS LAST LIMIT 1) ORDER BY T3.date ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.163,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 236,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.forename, T2.surname FROM pitStops AS T1...",
    "valid": true,
    "duration_ms": 5.597829818725586,
    "estimated_tokens": 197,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.forename, T2.surname FROM pitStops AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId WHERE T2.nationality = 'German' AND EXTRACT(YEAR FROM T2.dob) BETWEEN 1980 AND 1985 GROUP BY T2.forename, T2.surname ORDER BY AVG(CAST(T1.duration AS INTERVAL))  LIMIT 3",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 237,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.time FROM results AS T1 INNER JOIN races...",
    "valid": true,
    "duration_ms": 4.024505615234375,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.time FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId WHERE T2.name = 'Canadian Grand Prix' AND T2.year = 2008 AND T1.time LIKE '_:%:__.___'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 238,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T3.constructorRef, T3.url FROM results AS T...",
    "valid": true,
    "duration_ms": 5.656957626342773,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.constructorRef, T3.url FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN constructors AS T3 ON T1.constructorId = T3.constructorId WHERE T2.name = 'Singapore Grand Prix' AND T2.year = 2009 AND T1.time LIKE '_:%:__.___'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.107,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 239,
    "db_id": "superhero",
    "sql_snippet": "SELECT T3.power_name FROM superhero AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 3.9060115814208984,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.power_name FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T1.superhero_name = '3-D Man'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 240,
    "db_id": "formula_1",
    "sql_snippet": "SELECT SUM(T1.points), T2.name, T2.nationality FRO...",
    "valid": true,
    "duration_ms": 6.035089492797852,
    "estimated_tokens": 213,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(T1.points), T2.name, T2.nationality FROM constructorResults AS T1 INNER JOIN constructors AS T2 ON T1.constructorId = T2.constructorId INNER JOIN races AS T3 ON T3.raceid = T1.raceid WHERE T3.name = 'Monaco Grand Prix' AND T3.year BETWEEN 1980 AND 2010 GROUP BY T2.name, T2.nationality ORDER BY SUM(T1.points) DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.109,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 241,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T2.forename, T2.surname FROM qualifying AS ...",
    "valid": true,
    "duration_ms": 9.836196899414062,
    "estimated_tokens": 269,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.forename, T2.surname FROM qualifying AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId INNER JOIN races AS T3 ON T1.raceid = T3.raceid WHERE q3 IS NOT NULL AND T3.year = 2008 AND T3.circuitId IN (SELECT circuitId FROM circuits WHERE name = 'Marina Bay Street Circuit') ORDER BY CAST(SPLIT_PART(q3, ':', 1) AS INTEGER) * 60 + CAST(SPLIT_PART(SPLIT_PART(q3, ':', 2), '.', 1) AS REAL) + CAST(SPLIT_PART(q3, '.', 2) AS REAL) / 1000 ASC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.2,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 242,
    "db_id": "formula_1",
    "sql_snippet": "SELECT T1.forename, T1.surname, T1.nationality, T3...",
    "valid": true,
    "duration_ms": 6.633758544921875,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.forename, T1.surname, T1.nationality, T3.name FROM drivers AS T1 INNER JOIN driverStandings AS T2 ON T1.driverId = T2.driverId INNER JOIN races AS T3 ON T2.raceId = T3.raceId WHERE T1.dob notnull ORDER BY T1.dob DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 243,
    "db_id": "formula_1",
    "sql_snippet": "SELECT COUNT(T1.driverId) FROM results AS T1 INNER...",
    "valid": true,
    "duration_ms": 7.567882537841797,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.driverId) FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN status AS T3 ON T1.statusId = T3.statusId WHERE T3.statusId = 3 AND T2.name = 'Canadian Grand Prix' GROUP BY T1.driverId ORDER BY COUNT(T1.driverId) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.109,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 244,
    "db_id": "formula_1",
    "sql_snippet": "WITH lap_times_in_seconds AS (SELECT driverId, (CA...",
    "valid": true,
    "duration_ms": 21.947622299194336,
    "estimated_tokens": 383,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH lap_times_in_seconds AS (SELECT driverId, (CASE WHEN SPLIT_PART(time, ':', 1) <> '' THEN CAST(SPLIT_PART(time, ':', 1) AS float) * 60 ELSE 0 END + CASE WHEN SPLIT_PART(SPLIT_PART(time, ':', 2), '.', 1) <> '' THEN CAST(SPLIT_PART(SPLIT_PART(time, ':', 2), '.', 1) AS float) ELSE 0 END + CASE WHEN SPLIT_PART(SPLIT_PART(time, ':', 2), '.', 2) <> '' THEN CAST(SPLIT_PART(SPLIT_PART(time, ':', 2), '.', 2) AS float) / 1000 ELSE 0 END) AS time_in_seconds FROM lapTimes) SELECT T2.forename, T2.surname, T1.driverId FROM (SELECT driverId, MIN(time_in_seconds) AS min_time_in_seconds FROM lap_times_in_seconds GROUP BY driverId) AS T1 INNER JOIN drivers AS T2 ON T1.driverId = T2.driverId ORDER BY T1.min_time_in_seconds ASC LIMIT 20",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.137,
        "pattern_signature": "WITH-CTE-SELECT-FROM-JOIN-JOIN_INNER-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "CTE",
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WITH"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 1,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 245,
    "db_id": "formula_1",
    "sql_snippet": "WITH fastest_lap_times AS (SELECT T1.raceId, T1.Fa...",
    "valid": true,
    "duration_ms": 31.803131103515625,
    "estimated_tokens": 477,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH fastest_lap_times AS (SELECT T1.raceId, T1.FastestLapTime, (CAST(SPLIT_PART(T1.FastestLapTime, ':', 1) AS REAL) * 60) + (CAST(SPLIT_PART(SPLIT_PART(T1.FastestLapTime, ':', 2), '.', 1) AS REAL)) + (CAST(SPLIT_PART(T1.FastestLapTime, '.', 2) AS REAL) / 1000) AS time_in_seconds FROM results AS T1 WHERE T1.FastestLapTime IS NOT NULL) SELECT T1.FastestLapTime AS lap_record FROM results AS T1 INNER JOIN races AS T2 ON T1.raceId = T2.raceId INNER JOIN circuits AS T3 ON T2.circuitId = T3.circuitId INNER JOIN (SELECT MIN(fastest_lap_times.time_in_seconds) AS min_time_in_seconds FROM fastest_lap_times INNER JOIN races AS T2 ON fastest_lap_times.raceId = T2.raceId INNER JOIN circuits AS T3 ON T2.circuitId = T3.circuitId WHERE T3.country = 'Italy') AS T4 ON (CAST(SPLIT_PART(T1.FastestLapTime, ':', 1) AS REAL) * 60) + (CAST(SPLIT_PART(SPLIT_PART(T1.FastestLapTime, ':', 2), '.', 1) AS REAL)) + (CAST(SPLIT_PART(T1.FastestLapTime, '.', 2) AS REAL) / 1000) = T4.min_time_in_seconds LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.261,
        "pattern_signature": "WITH-CTE-SELECT-FROM-JOIN-JOIN_INNER-WHERE-LIMIT-SUBQUERY",
        "clauses_present": [
          "CTE",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "SELECT",
          "SUBQUERY",
          "WHERE",
          "WITH"
        ],
        "num_joins": 5,
        "num_subqueries": 1,
        "num_ctes": 1,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 246,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 6.089925765991211,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T3.power_name = 'Super Strength' AND T1.height_cm > 200",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 247,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 7.5130462646484375,
    "estimated_tokens": 181,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id INNER JOIN colour AS T4 ON T1.eye_colour_id = T4.id WHERE T3.power_name = 'Agility' AND T4.colour = 'Blue'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.138,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 248,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 5.253314971923828,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Blue' AND T3.colour = 'Blond'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 249,
    "db_id": "superhero",
    "sql_snippet": "SELECT superhero_name, height_cm, RANK() OVER (ORD...",
    "valid": true,
    "duration_ms": 5.113124847412109,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT superhero_name, height_cm, RANK() OVER (ORDER BY height_cm DESC NULLS LAST) AS HeightRank FROM superhero INNER JOIN publisher ON superhero.publisher_id = publisher.id WHERE publisher.publisher_name = 'Marvel Comics'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-WINDOW-ORDER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE",
          "WINDOW"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 250,
    "db_id": "superhero",
    "sql_snippet": "SELECT colour.colour AS EyeColor, COUNT(superhero....",
    "valid": true,
    "duration_ms": 8.801698684692383,
    "estimated_tokens": 187,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT colour.colour AS EyeColor, COUNT(superhero.id) AS Count, RANK() OVER (ORDER BY COUNT(superhero.id) DESC NULLS LAST) AS PopularityRank FROM superhero INNER JOIN colour ON superhero.eye_colour_id = colour.id INNER JOIN publisher ON superhero.publisher_id = publisher.id WHERE publisher.publisher_name = 'Marvel Comics' GROUP BY colour.colour",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.105,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-WINDOW-ORDER",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE",
          "WINDOW"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 251,
    "db_id": "superhero",
    "sql_snippet": "SELECT superhero_name FROM superhero AS T1 WHERE E...",
    "valid": true,
    "duration_ms": 8.002996444702148,
    "estimated_tokens": 191,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT superhero_name FROM superhero AS T1 WHERE EXISTS(SELECT 1 FROM hero_power AS T2 INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T3.power_name = 'Super Strength' AND T1.id = T2.hero_id) AND EXISTS(SELECT 1 FROM publisher AS T4 WHERE T4.publisher_name = 'Marvel Comics' AND T1.publisher_id = T4.id)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.116,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 252,
    "db_id": "superhero",
    "sql_snippet": "SELECT T2.publisher_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 6.901979446411133,
    "estimated_tokens": 205,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id INNER JOIN hero_attribute AS T3 ON T1.id = T3.hero_id INNER JOIN attribute AS T4 ON T3.attribute_id = T4.id WHERE T4.attribute_name = 'Speed' ORDER BY T3.attribute_value NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 253,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 6.001949310302734,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id INNER JOIN colour AS T3 ON T1.eye_colour_id = T3.id WHERE T2.publisher_name = 'Marvel Comics' AND T3.colour = 'Gold'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 254,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 5.238056182861328,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id WHERE T3.attribute_name = 'Intelligence' ORDER BY T2.attribute_value NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 255,
    "db_id": "superhero",
    "sql_snippet": "SELECT T2.race FROM superhero AS T1 INNER JOIN rac...",
    "valid": true,
    "duration_ms": 3.5436153411865234,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.race FROM superhero AS T1 INNER JOIN race AS T2 ON T1.race_id = T2.id WHERE T1.superhero_name = 'Copycat'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 256,
    "db_id": "superhero",
    "sql_snippet": "SELECT superhero_name FROM superhero AS T1 WHERE E...",
    "valid": true,
    "duration_ms": 5.654096603393555,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT superhero_name FROM superhero AS T1 WHERE EXISTS(SELECT 1 FROM hero_attribute AS T2 INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id WHERE T3.attribute_name = 'Durability' AND T2.attribute_value < 50 AND T1.id = T2.hero_id)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.08900000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 257,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.534482955932617,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T3.power_name = 'Death Touch'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 258,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 7.005214691162109,
    "estimated_tokens": 205,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id INNER JOIN gender AS T4 ON T1.gender_id = T4.id WHERE T3.attribute_name = 'Strength' AND T2.attribute_value = 100 AND T4.gender = 'Female'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14800000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 259,
    "db_id": "superhero",
    "sql_snippet": "SELECT (CAST(COUNT(*) AS REAL) * 100 / NULLIF((SEL...",
    "valid": true,
    "duration_ms": 11.499404907226562,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (CAST(COUNT(*) AS REAL) * 100 / NULLIF((SELECT COUNT(*) FROM superhero), 0)), CAST(SUM(CASE WHEN T2.publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END) AS REAL) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id INNER JOIN alignment AS T3 ON T3.id = T1.alignment_id WHERE T3.alignment = 'Bad'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.181,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 260,
    "db_id": "superhero",
    "sql_snippet": "SELECT SUM(CASE WHEN T2.publisher_name = 'Marvel C...",
    "valid": true,
    "duration_ms": 7.190704345703125,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T2.publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END) - SUM(CASE WHEN T2.publisher_name = 'DC Comics' THEN 1 ELSE 0 END) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 261,
    "db_id": "superhero",
    "sql_snippet": "SELECT id FROM publisher WHERE publisher_name = 'S...",
    "valid": true,
    "duration_ms": 2.513885498046875,
    "estimated_tokens": 91,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id FROM publisher WHERE publisher_name = 'Star Trek'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 262,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(id) FROM superhero WHERE full_name IS...",
    "valid": true,
    "duration_ms": 3.534078598022461,
    "estimated_tokens": 91,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(id) FROM superhero WHERE full_name IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 263,
    "db_id": "superhero",
    "sql_snippet": "SELECT AVG(T1.weight_kg) FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 6.6318511962890625,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T1.weight_kg) FROM superhero AS T1 INNER JOIN gender AS T2 ON T1.gender_id = T2.id WHERE T2.gender = 'Female'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 264,
    "db_id": "superhero",
    "sql_snippet": "SELECT T3.power_name FROM superhero AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 7.0362091064453125,
    "estimated_tokens": 188,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.power_name FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T3.id = T2.power_id INNER JOIN gender AS T4 ON T4.id = T1.gender_id WHERE T4.gender = 'Male' LIMIT 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 265,
    "db_id": "superhero",
    "sql_snippet": "SELECT DISTINCT T1.superhero_name FROM superhero A...",
    "valid": true,
    "duration_ms": 4.997968673706055,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id WHERE T1.height_cm BETWEEN 170 AND 190 AND T2.colour = 'No Colour'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 266,
    "db_id": "superhero",
    "sql_snippet": "SELECT DISTINCT T3.colour FROM superhero AS T1 INN...",
    "valid": true,
    "duration_ms": 6.964683532714844,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.colour FROM superhero AS T1 INNER JOIN race AS T2 ON T1.race_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T1.height_cm = 185 AND T2.race = 'Human'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 267,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T2.publisher_name = 'M...",
    "valid": true,
    "duration_ms": 8.531808853149414,
    "estimated_tokens": 177,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T2.publisher_name = 'Marvel Comics' THEN 1 ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.height_cm BETWEEN 150 AND 180",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 268,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 7.676601409912109,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN gender AS T2 ON T1.gender_id = T2.id WHERE T2.gender = 'Male' AND T1.weight_kg * 100 > (SELECT AVG(weight_kg) FROM superhero) * 79",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 269,
    "db_id": "superhero",
    "sql_snippet": "SELECT DISTINCT T2.power_name FROM hero_power AS T...",
    "valid": true,
    "duration_ms": 5.020380020141602,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.power_name FROM hero_power AS T1 INNER JOIN superpower AS T2 ON T1.power_id = T2.id WHERE T1.hero_id = 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 270,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.hero_id) FROM hero_power AS T1 INN...",
    "valid": true,
    "duration_ms": 4.027366638183594,
    "estimated_tokens": 136,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.hero_id) FROM hero_power AS T1 INNER JOIN superpower AS T2 ON T1.power_id = T2.id WHERE T2.power_name = 'Stealth'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 271,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.full_name FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 5.023956298828125,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.full_name FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id WHERE T3.attribute_name = 'Strength' ORDER BY T2.attribute_value DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 272,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 9.238719940185547,
    "estimated_tokens": 206,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T3.id = T2.attribute_id INNER JOIN publisher AS T4 ON T4.id = T1.publisher_id WHERE T4.publisher_name = 'Dark Horse Comics' AND T3.attribute_name = 'Durability' ORDER BY T2.attribute_value DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.132,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 273,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.eye_colour_id, T1.hair_colour_id, T1.ski...",
    "valid": true,
    "duration_ms": 5.998849868774414,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.eye_colour_id, T1.hair_colour_id, T1.skin_colour_id FROM superhero AS T1 INNER JOIN publisher AS T2 ON T2.id = T1.publisher_id INNER JOIN gender AS T3 ON T3.id = T1.gender_id WHERE T2.publisher_name = 'Dark Horse Comics' AND T3.gender = 'Female'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 274,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name, T2.publisher_name FROM s...",
    "valid": true,
    "duration_ms": 5.639314651489258,
    "estimated_tokens": 179,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name, T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.eye_colour_id = T1.hair_colour_id AND T1.eye_colour_id = T1.skin_colour_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 275,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T3.colour = 'Blue' THE...",
    "valid": true,
    "duration_ms": 9.533166885375977,
    "estimated_tokens": 202,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T3.colour = 'Blue' THEN T1.id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM superhero AS T1 INNER JOIN gender AS T2 ON T1.gender_id = T2.id INNER JOIN colour AS T3 ON T1.skin_colour_id = T3.id WHERE T2.gender = 'Female'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 276,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.power_id) FROM hero_power AS T1 IN...",
    "valid": true,
    "duration_ms": 3.210306167602539,
    "estimated_tokens": 138,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.power_id) FROM hero_power AS T1 INNER JOIN superhero AS T2 ON T1.hero_id = T2.id WHERE T2.superhero_name = 'Amazo'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 277,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.height_cm FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.9963722229003906,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.height_cm FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id WHERE T2.colour = 'Amber'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 278,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.995584487915039,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id AND T1.hair_colour_id = T2.id WHERE T2.colour = 'Black'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 279,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.161357879638672,
    "estimated_tokens": 145,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN alignment AS T2 ON T1.alignment_id = T2.id WHERE T2.alignment = 'Neutral'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 280,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.hero_id) FROM hero_attribute AS T1...",
    "valid": true,
    "duration_ms": 5.558252334594727,
    "estimated_tokens": 177,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.hero_id) FROM hero_attribute AS T1 INNER JOIN attribute AS T2 ON T1.attribute_id = T2.id WHERE T2.attribute_name = 'Strength' AND T1.attribute_value = (SELECT MAX(attribute_value) FROM hero_attribute)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.15000000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 281,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T2.publisher_name = 'M...",
    "valid": true,
    "duration_ms": 7.536411285400391,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T2.publisher_name = 'Marvel Comics' THEN 1 ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id INNER JOIN gender AS T3 ON T1.gender_id = T3.id WHERE T3.gender = 'Female'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 282,
    "db_id": "superhero",
    "sql_snippet": "SELECT (SELECT weight_kg FROM superhero WHERE full...",
    "valid": true,
    "duration_ms": 3.5376548767089844,
    "estimated_tokens": 123,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (SELECT weight_kg FROM superhero WHERE full_name LIKE 'Emil Blonsky') - (SELECT weight_kg FROM superhero WHERE full_name LIKE 'Charles Chandler') AS CALCULATE",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.132,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 283,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(SUM(height_cm) AS REAL) / NULLIF(COUNT...",
    "valid": true,
    "duration_ms": 3.019571304321289,
    "estimated_tokens": 114,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(height_cm) AS REAL) / NULLIF(COUNT(id), 0) FROM superhero",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 284,
    "db_id": "superhero",
    "sql_snippet": "SELECT T3.power_name FROM superhero AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 3.997802734375,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.power_name FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T1.superhero_name = 'Abomination'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 285,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.548311233520508,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id WHERE T3.attribute_name = 'Speed' ORDER BY T2.attribute_value DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 286,
    "db_id": "superhero",
    "sql_snippet": "SELECT T3.attribute_name, T2.attribute_value FROM ...",
    "valid": true,
    "duration_ms": 4.986047744750977,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.attribute_name, T2.attribute_value FROM superhero AS T1 INNER JOIN hero_attribute AS T2 ON T1.id = T2.hero_id INNER JOIN attribute AS T3 ON T2.attribute_id = T3.id WHERE T1.superhero_name = '3-D Man'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 287,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.655122756958008,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id INNER JOIN colour AS T3 ON T1.hair_colour_id = T3.id WHERE T2.colour = 'Blue' AND T3.colour = 'Brown'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 288,
    "db_id": "superhero",
    "sql_snippet": "SELECT T2.publisher_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 4.234075546264648,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.publisher_name FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id WHERE T1.superhero_name IN ('Hawkman', 'Karate Kid', 'Speedy')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 289,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T2.colour = 'Blue' THE...",
    "valid": true,
    "duration_ms": 6.998538970947266,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T2.colour = 'Blue' THEN 1 ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 290,
    "db_id": "superhero",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T2.gender = 'Male' THE...",
    "valid": true,
    "duration_ms": 9.051322937011719,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T2.gender = 'Male' THEN T1.id ELSE NULL END) AS REAL) / NULLIF(COUNT(CASE WHEN T2.gender = 'Female' THEN T1.id ELSE NULL END), 0) FROM superhero AS T1 INNER JOIN gender AS T2 ON T1.gender_id = T2.id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 291,
    "db_id": "superhero",
    "sql_snippet": "SELECT T2.colour FROM superhero AS T1 INNER JOIN c...",
    "valid": true,
    "duration_ms": 3.7069320678710938,
    "estimated_tokens": 149,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.colour FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id WHERE T1.full_name = 'Karen Beecher-Duncan'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 292,
    "db_id": "superhero",
    "sql_snippet": "SELECT SUM(CASE WHEN T2.id = 7 THEN 1 ELSE 0 END) ...",
    "valid": true,
    "duration_ms": 6.546497344970703,
    "estimated_tokens": 188,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T2.id = 7 THEN 1 ELSE 0 END) - SUM(CASE WHEN T2.id = 1 THEN 1 ELSE 0 END) FROM superhero AS T1 INNER JOIN colour AS T2 ON T1.eye_colour_id = T2.id WHERE T1.weight_kg = 0 OR T1.weight_kg IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 293,
    "db_id": "superhero",
    "sql_snippet": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 5.606889724731445,
    "estimated_tokens": 173,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM superhero AS T1 INNER JOIN alignment AS T2 ON T1.alignment_id = T2.id INNER JOIN colour AS T3 ON T1.skin_colour_id = T3.id WHERE T2.alignment = 'Bad' AND T3.colour = 'Green'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 294,
    "db_id": "superhero",
    "sql_snippet": "SELECT T1.superhero_name FROM superhero AS T1 INNE...",
    "valid": true,
    "duration_ms": 6.517887115478516,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.superhero_name FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id WHERE T3.power_name = 'Wind Control' ORDER BY T1.superhero_name NULLS FIRST",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 295,
    "db_id": "superhero",
    "sql_snippet": "SELECT T4.gender FROM superhero AS T1 INNER JOIN h...",
    "valid": true,
    "duration_ms": 7.432222366333008,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T4.gender FROM superhero AS T1 INNER JOIN hero_power AS T2 ON T1.id = T2.hero_id INNER JOIN superpower AS T3 ON T2.power_id = T3.id INNER JOIN gender AS T4 ON T1.gender_id = T4.id WHERE T3.power_name = 'Phoenix Force'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 296,
    "db_id": "superhero",
    "sql_snippet": "SELECT SUM(CASE WHEN T2.publisher_name = 'DC Comic...",
    "valid": true,
    "duration_ms": 6.222724914550781,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T2.publisher_name = 'DC Comics' THEN 1 ELSE 0 END) - SUM(CASE WHEN T2.publisher_name = 'Marvel Comics' THEN 1 ELSE 0 END) FROM superhero AS T1 INNER JOIN publisher AS T2 ON T1.publisher_id = T2.id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 297,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT DisplayName FROM users WHERE DisplayName IN...",
    "valid": true,
    "duration_ms": 4.198551177978516,
    "estimated_tokens": 140,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DisplayName FROM users WHERE DisplayName IN ('Harlan', 'Jarrod Dixon') AND Reputation = (SELECT MAX(Reputation) FROM users WHERE DisplayName IN ('Harlan', 'Jarrod Dixon'))",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.11600000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 298,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT DisplayName FROM users WHERE TO_CHAR(CAST(C...",
    "valid": true,
    "duration_ms": 2.6483535766601562,
    "estimated_tokens": 106,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DisplayName FROM users WHERE TO_CHAR(CAST(CreationDate AS TIMESTAMP), 'YYYY') = '2011'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 299,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(Id) FROM users WHERE DATE(LastAccessD...",
    "valid": true,
    "duration_ms": 2.9745101928710938,
    "estimated_tokens": 105,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(Id) FROM users WHERE DATE(LastAccessDate) > '2014-09-01'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 300,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.539966583251953,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T1.Title = 'Eliciting priors from experts'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 301,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T1.id) FROM posts AS T1 INNER JOIN us...",
    "valid": true,
    "duration_ms": 4.61888313293457,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T2.DisplayName = 'csgillespie'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 302,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.0130615234375,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN users AS T2 ON T1.LastEditorUserId = T2.Id WHERE T1.Title = 'Examples for teaching: Correlation does not mean causation'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 303,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T1.Id) FROM posts AS T1 INNER JOIN us...",
    "valid": true,
    "duration_ms": 5.88226318359375,
    "estimated_tokens": 138,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.Id) FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T1.Score >= 20 AND T2.Age > 65",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 304,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.Body FROM tags AS T1 INNER JOIN posts AS...",
    "valid": true,
    "duration_ms": 5.843639373779297,
    "estimated_tokens": 142,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Body FROM tags AS T1 INNER JOIN posts AS T2 ON T2.Id = T1.ExcerptPostId WHERE T1.TagName = 'bayesian'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 305,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT AVG(T1.Score) FROM posts AS T1 INNER JOIN u...",
    "valid": true,
    "duration_ms": 3.996610641479492,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T1.Score) FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T2.DisplayName = 'csgillespie'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 306,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.Age > 65 THEN 1 ELSE ...",
    "valid": true,
    "duration_ms": 7.489919662475586,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.Age > 65 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.Id), 0) FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T1.Score > 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 307,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.FavoriteCount FROM posts AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 4.000663757324219,
    "estimated_tokens": 173,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.FavoriteCount FROM posts AS T1 INNER JOIN comments AS T2 ON T1.Id = T2.PostId WHERE T2.CreationDate = '2014-04-23 20:29:39.0' AND T2.UserId = 3025",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 308,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CASE WHEN T2.ClosedDate IS NULL THEN 'NOT w...",
    "valid": true,
    "duration_ms": 5.140066146850586,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN T2.ClosedDate IS NULL THEN 'NOT well-finished' ELSE 'well-finished' END AS resylt FROM comments AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id WHERE T1.UserId = 23853 AND T1.CreationDate = '2013-07-12 09:08:18.0'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 309,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T1.Id) FROM users AS T1 INNER JOIN po...",
    "valid": true,
    "duration_ms": 4.000186920166016,
    "estimated_tokens": 133,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.Id) FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId WHERE T1.DisplayName = 'Tiago Pasqualini'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 310,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 2.9990673065185547,
    "estimated_tokens": 142,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId WHERE T2.Id = 6347",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 311,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(COUNT(DISTINCT T2.Id) AS REAL) / NULLI...",
    "valid": true,
    "duration_ms": 7.110118865966797,
    "estimated_tokens": 152,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(DISTINCT T2.Id) AS REAL) / NULLIF(COUNT(DISTINCT T1.Id), 0) FROM votes AS T1 INNER JOIN posts AS T2 ON T1.UserId = T2.OwnerUserId WHERE T1.UserId = 24",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 312,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT ViewCount FROM posts WHERE Title = 'Integra...",
    "valid": true,
    "duration_ms": 3.0188560485839844,
    "estimated_tokens": 104,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ViewCount FROM posts WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 313,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT Text FROM comments WHERE Score = 17",
    "valid": true,
    "duration_ms": 3.0002593994140625,
    "estimated_tokens": 88,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT Text FROM comments WHERE Score = 17",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 314,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.513025283813477,
    "estimated_tokens": 144,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN comments AS T2 ON T1.Id = T2.UserId WHERE T2.Text = 'thank you user93!'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 315,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.DisplayName, T1.Reputation FROM users AS...",
    "valid": true,
    "duration_ms": 4.52876091003418,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.DisplayName, T1.Reputation FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId WHERE T2.Title = 'Understanding what Dassault iSight is doing?'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 316,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.016637802124023,
    "estimated_tokens": 149,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.DisplayName FROM posts AS T1 INNER JOIN users AS T2 ON T1.OwnerUserId = T2.Id WHERE T1.Title = 'Open source tools for visualizing multi-dimensional data?'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 317,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.Comment FROM posts AS T1 INNER JOIN post...",
    "valid": true,
    "duration_ms": 5.158424377441406,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Comment FROM posts AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.PostId WHERE T1.Title = 'Why square the difference instead of taking the absolute value in standard deviation?'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 318,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T3.DisplayName, T1.Title FROM posts AS T1 I...",
    "valid": true,
    "duration_ms": 6.011009216308594,
    "estimated_tokens": 157,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.DisplayName, T1.Title FROM posts AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.PostId INNER JOIN users AS T3 ON T3.Id = T2.UserId WHERE T2.BountyAmount = 50 AND T1.Title LIKE '%variance%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 319,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT AVG(T2.ViewCount) AS AverageViewCount, T2.T...",
    "valid": true,
    "duration_ms": 5.001068115234375,
    "estimated_tokens": 158,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.ViewCount) AS AverageViewCount, T2.Title, T1.Text FROM comments AS T1 INNER JOIN posts AS T2 ON T2.Id = T1.PostId WHERE T2.Tags = '<humor>' GROUP BY T2.Title, T1.Text",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 320,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(UserId) FROM (SELECT UserId, COUNT(Na...",
    "valid": true,
    "duration_ms": 3.778219223022461,
    "estimated_tokens": 133,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(UserId) FROM (SELECT UserId, COUNT(Name) AS num FROM badges GROUP BY UserId) AS T WHERE T.num > 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10500000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-GROUP-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 321,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.UserId FROM users AS T1 INNER JOIN postH...",
    "valid": true,
    "duration_ms": 7.962703704833984,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.UserId FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T3.ViewCount >= 1000 GROUP BY T2.UserId HAVING COUNT(DISTINCT T2.PostHistoryTypeId) = 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.1,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 322,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(Date AS TIM...",
    "valid": true,
    "duration_ms": 12.378215789794922,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(Date AS TIMESTAMP), 'YYYY') = '2010' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(Id), 0) - CAST(SUM(CASE WHEN TO_CHAR(CAST(Date AS TIMESTAMP), 'YYYY') = '2011' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(Id), 0) FROM badges WHERE Name = 'Student'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.041,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 4
      }
    }
  },
  {
    "query_idx": 323,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT AVG(T1.UpVotes), AVG(T1.Age) FROM users AS ...",
    "valid": true,
    "duration_ms": 7.362842559814453,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T1.UpVotes), AVG(T1.Age) FROM users AS T1 INNER JOIN (SELECT OwnerUserId, COUNT(*) AS post_count FROM posts GROUP BY OwnerUserId HAVING COUNT(*) > 10) AS T2 ON T1.Id = T2.OwnerUserId",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.152,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-GROUP-HAVING-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 4
      }
    }
  },
  {
    "query_idx": 324,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(CreationDat...",
    "valid": true,
    "duration_ms": 7.657289505004883,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(CreationDate AS TIMESTAMP), 'YYYY') = '2010' THEN 1 ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN TO_CHAR(CAST(CreationDate AS TIMESTAMP), 'YYYY') = '2011' THEN 1 ELSE 0 END), 0) FROM votes",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 325,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.PostId FROM users AS T1 INNER JOIN postH...",
    "valid": true,
    "duration_ms": 6.235599517822266,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.PostId FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T1.DisplayName = 'slashnick' ORDER BY T3.AnswerCount DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 326,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 6.733894348144531,
    "estimated_tokens": 204,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T2.PostId = T3.Id WHERE T1.DisplayName = 'Harvey Motulsky' OR T1.DisplayName = 'Noah Snyder' GROUP BY T1.DisplayName ORDER BY SUM(T3.ViewCount) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 327,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T3.Tags FROM users AS T1 INNER JOIN postHis...",
    "valid": true,
    "duration_ms": 4.017114639282227,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.Tags FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T3.Id = T2.PostId WHERE T1.DisplayName = 'Mark Meckes' AND T3.CommentCount = 0",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 328,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T3.TagName = 'r' THEN 1 ...",
    "valid": true,
    "duration_ms": 5.935430526733398,
    "estimated_tokens": 197,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T3.TagName = 'r' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.Id), 0) FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN tags AS T3 ON T3.ExcerptPostId = T2.PostId WHERE T1.DisplayName = 'Community'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 329,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT SUM(CASE WHEN T1.DisplayName = 'Mornington'...",
    "valid": true,
    "duration_ms": 5.651235580444336,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T1.DisplayName = 'Mornington' THEN T3.ViewCount ELSE 0 END) - SUM(CASE WHEN T1.DisplayName = 'Amos' THEN T3.ViewCount ELSE 0 END) AS diff FROM users AS T1 INNER JOIN postHistory AS T2 ON T1.Id = T2.UserId INNER JOIN posts AS T3 ON T3.Id = T2.PostId",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.092,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 330,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(COUNT(T1.Id) AS REAL) / NULLIF(12, 0) ...",
    "valid": true,
    "duration_ms": 6.582498550415039,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(T1.Id) AS REAL) / NULLIF(12, 0) FROM postLinks AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id WHERE T2.AnswerCount <= 2 AND TO_CHAR(CAST(T1.CreationDate AS TIMESTAMP), 'YYYY') = '2010'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 331,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.CreationDate FROM users AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 3.6618709564208984,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.CreationDate FROM users AS T1 INNER JOIN votes AS T2 ON T1.Id = T2.UserId WHERE T1.DisplayName = 'chl' ORDER BY T2.CreationDate NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 332,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 3.9894580841064453,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.DisplayName FROM users AS T1 INNER JOIN badges AS T2 ON T1.Id = T2.UserId WHERE T2.name = 'Autobiographer' ORDER BY T2.Date LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 333,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T1.Id) FROM users AS T1 INNER JOIN po...",
    "valid": true,
    "duration_ms": 3.110647201538086,
    "estimated_tokens": 139,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.Id) FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId WHERE T1.Location = 'United Kingdom' AND T2.FavoriteCount >= 4",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 334,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.Id, T2.Title FROM users AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 3.734588623046875,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Id, T2.Title FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId WHERE T1.DisplayName = 'Harvey Motulsky' ORDER BY T2.ViewCount DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 335,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.OwnerUserId, T1.DisplayName FROM users A...",
    "valid": true,
    "duration_ms": 3.9985179901123047,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.OwnerUserId, T1.DisplayName FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId WHERE TO_CHAR(CAST(T1.CreationDate AS TIMESTAMP), 'YYYY') = '2010' ORDER BY T2.FavoriteCount DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 336,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(T2.CreaionD...",
    "valid": true,
    "duration_ms": 5.557537078857422,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN TO_CHAR(CAST(T2.CreaionDate AS TIMESTAMP), 'YYYY') = '2011' AND T1.Reputation > 1000 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.Id), 0) FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.067,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 337,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.ViewCount, T3.DisplayName FROM postHisto...",
    "valid": true,
    "duration_ms": 5.436897277832031,
    "estimated_tokens": 152,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.ViewCount, T3.DisplayName FROM postHistory AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id INNER JOIN users AS T3 ON T2.LastEditorUserId = T3.Id WHERE T1.Text = 'Computer Game Datasets'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 338,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T2.Id) FROM posts AS T1 INNER JOIN co...",
    "valid": true,
    "duration_ms": 2.9799938201904297,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.Id) FROM posts AS T1 INNER JOIN comments AS T2 ON T1.Id = T2.PostId GROUP BY T1.Id ORDER BY T1.Score DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.051000000000000004,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 339,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T3.Text, T1.DisplayName FROM users AS T1 IN...",
    "valid": true,
    "duration_ms": 5.30242919921875,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.Text, T1.DisplayName FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId INNER JOIN comments AS T3 ON T2.Id = T3.PostId WHERE T2.Title = 'Analysing wind data with R' ORDER BY T1.CreationDate DESC NULLS LAST LIMIT 10",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 340,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.Score > 50 THEN 1 ELS...",
    "valid": true,
    "duration_ms": 7.650852203369141,
    "estimated_tokens": 191,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.Score > 50 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.Id), 0) FROM users AS T1 INNER JOIN posts AS T2 ON T1.Id = T2.OwnerUserId INNER JOIN (SELECT MAX(Reputation) AS max_reputation FROM users) AS T3 ON T1.Reputation = T3.max_reputation",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.164,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 341,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT ExcerptPostId, WikiPostId FROM tags WHERE T...",
    "valid": true,
    "duration_ms": 1.0020732879638672,
    "estimated_tokens": 93,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ExcerptPostId, WikiPostId FROM tags WHERE TagName = 'sample'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 342,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT T2.Reputation, T2.UpVotes FROM comments AS ...",
    "valid": true,
    "duration_ms": 3.0002593994140625,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Reputation, T2.UpVotes FROM comments AS T1 INNER JOIN users AS T2 ON T1.UserId = T2.Id WHERE T1.Text = 'fine, you win :)'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 343,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT Text FROM comments WHERE PostId IN (SELECT ...",
    "valid": true,
    "duration_ms": 4.359245300292969,
    "estimated_tokens": 143,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT Text FROM comments WHERE PostId IN (SELECT Id FROM posts WHERE ViewCount BETWEEN 100 AND 150) ORDER BY Score DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.11000000000000001,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 344,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT COUNT(T1.id) FROM comments AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 2.9959678649902344,
    "estimated_tokens": 136,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM comments AS T1 INNER JOIN posts AS T2 ON T1.PostId = T2.Id WHERE T2.CommentCount = 1 AND T2.Score = 0",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 345,
    "db_id": "codebase_community",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.UpVotes = 0 THEN 1 EL...",
    "valid": true,
    "duration_ms": 4.987001419067383,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.UpVotes = 0 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.Id), 0) AS per FROM users AS T1 INNER JOIN comments AS T2 ON T1.Id = T2.UserId WHERE T2.Score BETWEEN 5 AND 10",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 346,
    "db_id": "card_games",
    "sql_snippet": "SELECT id FROM cards WHERE NOT cardKingdomFoilId I...",
    "valid": true,
    "duration_ms": 2.09808349609375,
    "estimated_tokens": 113,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id FROM cards WHERE NOT cardKingdomFoilId IS NULL AND NOT cardKingdomId IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.027000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 347,
    "db_id": "card_games",
    "sql_snippet": "SELECT id FROM cards WHERE borderColor = 'borderle...",
    "valid": true,
    "duration_ms": 3.1943321228027344,
    "estimated_tokens": 119,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id FROM cards WHERE borderColor = 'borderless' AND (cardKingdomId IS NULL OR cardKingdomId IS NULL)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.037000000000000005,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 348,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T1.id FROM cards AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 3.114938735961914,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.id FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T2.format = 'gladiator' AND T2.status = 'Banned' AND T1.rarity = 'mythic'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 349,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T2.status FROM cards AS T1 INNER J...",
    "valid": true,
    "duration_ms": 2.9821395874023438,
    "estimated_tokens": 163,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.status FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T1.type = 'Artifact' AND T2.format = 'vintage' AND T1.side IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 350,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.id, T1.artist FROM cards AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.9472579956054688,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.id, T1.artist FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T2.status = 'Legal' AND T2.format = 'commander' AND (T1.power IS NULL OR T1.power = '*')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.082,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 351,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.id, T2.text, T1.hasContentWarning FROM c...",
    "valid": true,
    "duration_ms": 3.0019283294677734,
    "estimated_tokens": 153,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.id, T2.text, T1.hasContentWarning FROM cards AS T1 INNER JOIN rulings AS T2 ON T1.uuid = T2.uuid WHERE T1.artist = 'Stephen Daniele'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 352,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.name, T1.artist, T1.isPromo FROM cards A...",
    "valid": true,
    "duration_ms": 6.991386413574219,
    "estimated_tokens": 238,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.name, T1.artist, T1.isPromo FROM cards AS T1 INNER JOIN rulings AS T2 ON T1.uuid = T2.uuid WHERE T1.isPromo = 1 AND T1.artist = (SELECT artist FROM cards WHERE isPromo = 1 GROUP BY artist HAVING COUNT(DISTINCT uuid) = (SELECT MAX(count_uuid) FROM (SELECT COUNT(DISTINCT uuid) AS count_uuid FROM cards WHERE isPromo = 1 GROUP BY artist) AS subquery)) LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.32900000000000007,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 3,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 353,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.language = 'Chinese S...",
    "valid": true,
    "duration_ms": 4.614353179931641,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.language = 'Chinese Simplified' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T1.uuid = T2.uuid",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.05700000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 354,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(*) FROM cards WHERE power = '*'",
    "valid": true,
    "duration_ms": 2.005338668823242,
    "estimated_tokens": 87,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(*) FROM cards WHERE power = '*'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 355,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT borderColor FROM cards WHERE name ...",
    "valid": true,
    "duration_ms": 2.019166946411133,
    "estimated_tokens": 99,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT borderColor FROM cards WHERE name = 'Ancestor''s Chosen'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 356,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.format FROM cards AS T1 INNER JOIN legal...",
    "valid": true,
    "duration_ms": 3.0028820037841797,
    "estimated_tokens": 144,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.format FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T1.name = 'Benalish Knight'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 357,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN borderColor = 'borderles...",
    "valid": true,
    "duration_ms": 3.562450408935547,
    "estimated_tokens": 132,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN borderColor = 'borderless' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(id), 0) FROM cards",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 358,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.language = 'French' T...",
    "valid": true,
    "duration_ms": 5.055427551269531,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.language = 'French' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T1.uuid = T2.uuid WHERE T1.isStorySpotlight = 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 359,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(id) FROM cards WHERE originalType = '...",
    "valid": true,
    "duration_ms": 3.017902374267578,
    "estimated_tokens": 100,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(id) FROM cards WHERE originalType = 'Summon - Angel' AND subtypes <> 'Angel'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.033,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 360,
    "db_id": "card_games",
    "sql_snippet": "SELECT id FROM cards WHERE duelDeck = 'a'",
    "valid": true,
    "duration_ms": 1.669168472290039,
    "estimated_tokens": 89,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT id FROM cards WHERE duelDeck = 'a'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 361,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN le...",
    "valid": true,
    "duration_ms": 3.5409927368164062,
    "estimated_tokens": 138,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T2.status = 'Banned' AND T1.borderColor = 'white'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 362,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T1.name FROM cards AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 5.015850067138672,
    "estimated_tokens": 159,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.name FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T1.uuid = T2.uuid WHERE T1.originalType = 'Artifact' AND T1.colors = 'B'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 363,
    "db_id": "card_games",
    "sql_snippet": "SELECT manaCost FROM cards WHERE availability = 'm...",
    "valid": true,
    "duration_ms": 1.9919872283935547,
    "estimated_tokens": 115,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT manaCost FROM cards WHERE availability = 'mtgo,paper' AND borderColor = 'black' AND frameVersion = '2003' AND layout = 'normal'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.047,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 364,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN isTextless = 0 AND isSto...",
    "valid": true,
    "duration_ms": 3.7238597869873047,
    "estimated_tokens": 123,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN isTextless = 0 AND isStorySpotlight = 1 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(id), 0) FROM cards",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.032,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 365,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(T1.id) FROM sets AS T1 INNER JOIN set...",
    "valid": true,
    "duration_ms": 2.539396286010742,
    "estimated_tokens": 141,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T2.language = 'Portuguese (Brazil)' AND T1.block = 'Commander'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 366,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.subtypes, T1.supertypes FROM cards AS T1...",
    "valid": true,
    "duration_ms": 4.037141799926758,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.subtypes, T1.supertypes FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T1.uuid = T2.uuid WHERE T2.language = 'German' AND NOT T1.subtypes IS NULL AND NOT T1.supertypes IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 367,
    "db_id": "card_games",
    "sql_snippet": "SELECT Count(DISTINCT T1.id) FROM cards AS T1 INNE...",
    "valid": true,
    "duration_ms": 3.6537647247314453,
    "estimated_tokens": 160,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT Count(DISTINCT T1.id) FROM cards AS T1 INNER JOIN rulings AS T2 ON T1.uuid = T2.uuid WHERE (T1.power IS NULL OR T1.power = '*') AND T2.text LIKE '%triggered ability%'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 368,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN le...",
    "valid": true,
    "duration_ms": 4.003763198852539,
    "estimated_tokens": 167,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid INNER JOIN rulings AS T3 ON T1.uuid = T3.uuid WHERE T2.format = 'premodern' AND T3.text = 'This is a triggered mana ability.' AND T1.Side IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.113,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 369,
    "db_id": "card_games",
    "sql_snippet": "SELECT name FROM foreign_data WHERE uuid IN (SELEC...",
    "valid": true,
    "duration_ms": 3.5414695739746094,
    "estimated_tokens": 146,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT name FROM foreign_data WHERE uuid IN (SELECT uuid FROM cards WHERE types = 'Creature' AND layout = 'normal' AND borderColor = 'black' AND artist = 'Matthew D. Wilson') AND language = 'French'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.15000000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 370,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.language FROM sets AS T1 INNER JOIN set_...",
    "valid": true,
    "duration_ms": 3.5619735717773438,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.block = 'Ravnica' AND T1.baseSetSize = 180",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 371,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.hasContentWarning = 0...",
    "valid": true,
    "duration_ms": 6.026983261108398,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.hasContentWarning = 0 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T2.format = 'commander' AND T2.status = 'Legal'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 372,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.language = 'French' T...",
    "valid": true,
    "duration_ms": 4.56690788269043,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.language = 'French' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T1.uuid = T2.uuid WHERE T1.power IS NULL OR T1.power = '*'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 373,
    "db_id": "card_games",
    "sql_snippet": "SELECT language FROM foreign_data WHERE multiverse...",
    "valid": true,
    "duration_ms": 2.6521682739257812,
    "estimated_tokens": 95,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT language FROM foreign_data WHERE multiverseid = 149934",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 374,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN isTextless = 1 AND layou...",
    "valid": true,
    "duration_ms": 4.03594970703125,
    "estimated_tokens": 121,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN isTextless = 1 AND layout = 'normal' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(*), 0) FROM cards",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.032,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 375,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.language FROM sets AS T1 INNER JOIN set_...",
    "valid": true,
    "duration_ms": 2.997159957885742,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.language FROM sets AS T1 INNER JOIN set_translations AS T2 ON T1.code = T2.setCode WHERE T1.mcmName = 'Archenemy' AND T2.setCode = 'ARC'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 376,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT language FROM foreign_data WHERE n...",
    "valid": true,
    "duration_ms": 2.061605453491211,
    "estimated_tokens": 101,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT language FROM foreign_data WHERE name = 'A Pedra Fellwar'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 377,
    "db_id": "card_games",
    "sql_snippet": "SELECT name FROM cards WHERE name IN ('Serra Angel...",
    "valid": true,
    "duration_ms": 2.8154850006103516,
    "estimated_tokens": 115,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT name FROM cards WHERE name IN ('Serra Angel', 'Shrine Keeper') ORDER BY convertedManaCost DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 378,
    "db_id": "card_games",
    "sql_snippet": "SELECT translation FROM set_translations WHERE set...",
    "valid": true,
    "duration_ms": 2.6559829711914062,
    "estimated_tokens": 127,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT translation FROM set_translations WHERE setCode IN (SELECT setCode FROM cards WHERE name = 'Ancestor''s Chosen') AND language = 'Italian'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12000000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 379,
    "db_id": "card_games",
    "sql_snippet": "SELECT CASE WHEN SUM(CASE WHEN T2.language = 'Kore...",
    "valid": true,
    "duration_ms": 6.020545959472656,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN SUM(CASE WHEN T2.language = 'Korean' AND NOT T2.translation IS NULL THEN 1 ELSE 0 END) > 0 THEN 'YES' ELSE 'NO' END FROM cards AS T1 INNER JOIN set_translations AS T2 ON T2.setCode = T1.setCode WHERE T1.name = 'Ancestor''s Chosen'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 380,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN se...",
    "valid": true,
    "duration_ms": 3.245830535888672,
    "estimated_tokens": 144,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM cards AS T1 INNER JOIN set_translations AS T2 ON T2.setCode = T1.setCode WHERE T2.translation = 'Hauptset Zehnte Edition' AND T1.artist = 'Adam Rex'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 381,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.translation FROM sets AS T1 INNER JOIN s...",
    "valid": true,
    "duration_ms": 3.148794174194336,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.translation FROM sets AS T1 INNER JOIN set_translations AS T2 ON T2.setCode = T1.code WHERE T1.name = 'Eighth Edition' AND T2.language = 'Chinese Simplified'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 382,
    "db_id": "card_games",
    "sql_snippet": "SELECT CASE WHEN NOT T2.mtgoCode IS NULL THEN 'YES...",
    "valid": true,
    "duration_ms": 3.192424774169922,
    "estimated_tokens": 158,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN NOT T2.mtgoCode IS NULL THEN 'YES' ELSE 'NO' END FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE T1.name = 'Angel of Mercy'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 383,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(DISTINCT T1.id) FROM sets AS T1 INNER...",
    "valid": true,
    "duration_ms": 3.9925575256347656,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T1.id) FROM sets AS T1 INNER JOIN set_translations AS T2 ON T2.setCode = T1.code WHERE T1.block = 'Ice Age' AND T2.language = 'Italian' AND NOT T2.translation IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 384,
    "db_id": "card_games",
    "sql_snippet": "SELECT CASE WHEN isForeignOnly = 1 THEN 'YES' ELSE...",
    "valid": true,
    "duration_ms": 2.111673355102539,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CASE WHEN isForeignOnly = 1 THEN 'YES' ELSE 'NO' END FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE T1.name = 'Adarkar Valkyrie'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 385,
    "db_id": "card_games",
    "sql_snippet": "SELECT COUNT(T1.id) FROM sets AS T1 INNER JOIN set...",
    "valid": true,
    "duration_ms": 4.7206878662109375,
    "estimated_tokens": 164,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.id) FROM sets AS T1 INNER JOIN set_translations AS T2 ON T2.setCode = T1.code WHERE NOT T2.translation IS NULL AND T1.baseSetSize < 100 AND T2.language = 'Italian'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 386,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.artist FROM cards AS T1 INNER JOIN sets ...",
    "valid": true,
    "duration_ms": 6.000518798828125,
    "estimated_tokens": 206,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.artist FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE (T2.name = 'Coldsnap' AND T1.artist = 'Chippy') OR (T2.name = 'Coldsnap' AND T1.artist = 'Aaron Miller') OR (T2.name = 'Coldsnap' AND T1.artist = 'Jeremy Jarvis') GROUP BY T1.artist",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 387,
    "db_id": "card_games",
    "sql_snippet": "SELECT SUM(CASE WHEN T1.power = '*' OR T1.power IS...",
    "valid": true,
    "duration_ms": 3.4208297729492188,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT SUM(CASE WHEN T1.power = '*' OR T1.power IS NULL THEN 1 ELSE 0 END) FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE T2.name = 'Coldsnap' AND T1.convertedManaCost > 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 388,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.flavorText FROM cards AS T1 INNER JOIN f...",
    "valid": true,
    "duration_ms": 2.683401107788086,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.flavorText FROM cards AS T1 INNER JOIN foreign_data AS T2 ON T2.uuid = T1.uuid WHERE T1.name = 'Ancestor''s Chosen' AND T2.language = 'Italian'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 389,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T1.text FROM foreign_data AS T1 IN...",
    "valid": true,
    "duration_ms": 4.013299942016602,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.text FROM foreign_data AS T1 INNER JOIN cards AS T2 ON T2.uuid = T1.uuid INNER JOIN sets AS T3 ON T3.code = T2.setCode WHERE T3.name = 'Coldsnap' AND T1.language = 'Italian'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 390,
    "db_id": "card_games",
    "sql_snippet": "SELECT T2.name FROM foreign_data AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.026889801025391,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.name FROM foreign_data AS T1 INNER JOIN cards AS T2 ON T2.uuid = T1.uuid INNER JOIN sets AS T3 ON T3.code = T2.setCode WHERE T3.name = 'Coldsnap' AND T1.language = 'Italian' ORDER BY T2.convertedManaCost DESC NULLS LAST",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 391,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.convertedManaCost = 7...",
    "valid": true,
    "duration_ms": 5.213499069213867,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.convertedManaCost = 7 THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE T2.name = 'Coldsnap'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 392,
    "db_id": "card_games",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN NOT T1.cardKingdomFoilId...",
    "valid": true,
    "duration_ms": 5.016088485717773,
    "estimated_tokens": 194,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN NOT T1.cardKingdomFoilId IS NULL AND NOT T1.cardKingdomId IS NULL THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.id), 0) FROM cards AS T1 INNER JOIN sets AS T2 ON T2.code = T1.setCode WHERE T2.name = 'Coldsnap'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07400000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 393,
    "db_id": "card_games",
    "sql_snippet": "WITH MaxBanned AS (SELECT format FROM legalities W...",
    "valid": true,
    "duration_ms": 7.272958755493164,
    "estimated_tokens": 207,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH MaxBanned AS (SELECT format FROM legalities WHERE status = 'Banned' GROUP BY format ORDER BY COUNT(*) DESC LIMIT 1)SELECT T2.format, T1.name FROM cards AS T1 INNER JOIN legalities AS T2 ON T2.uuid = T1.uuid INNER JOIN MaxBanned MB ON MB.format = T2.format WHERE T2.status = 'Banned'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "WITH-CTE-SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "CTE",
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE",
          "WITH"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 1,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 394,
    "db_id": "card_games",
    "sql_snippet": "SELECT T1.name, T2.format FROM cards AS T1 INNER J...",
    "valid": true,
    "duration_ms": 4.009485244750977,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.name, T2.format FROM cards AS T1 INNER JOIN legalities AS T2 ON T2.uuid = T1.uuid WHERE T1.edhrecRank = 1 AND T2.status = 'Banned' GROUP BY T1.name, T2.format",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 395,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T2.name, CASE WHEN T1.status = 'Le...",
    "valid": true,
    "duration_ms": 5.0029754638671875,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.name, CASE WHEN T1.status = 'Legal' THEN T1.format ELSE NULL END FROM legalities AS T1 INNER JOIN cards AS T2 ON T2.uuid = T1.uuid WHERE T2.setCode IN (SELECT code FROM sets WHERE name = 'Hour of Devastation')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14500000000000002,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 396,
    "db_id": "card_games",
    "sql_snippet": "SELECT name FROM sets WHERE code IN (SELECT setCod...",
    "valid": true,
    "duration_ms": 3.0388832092285156,
    "estimated_tokens": 126,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT name FROM sets WHERE code IN (SELECT setCode FROM set_translations WHERE language = 'Korean' AND NOT language LIKE '%Japanese%')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.12000000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 397,
    "db_id": "card_games",
    "sql_snippet": "SELECT DISTINCT T1.frameVersion, T1.name, CASE WHE...",
    "valid": true,
    "duration_ms": 4.543542861938477,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.frameVersion, T1.name, CASE WHEN T2.status = 'Banned' THEN T1.name ELSE 'NO' END FROM cards AS T1 INNER JOIN legalities AS T2 ON T1.uuid = T2.uuid WHERE T1.artist = 'Allen Williams'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 398,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T.bond_type FROM (SELECT bond_type, COUNT(b...",
    "valid": true,
    "duration_ms": 2.9985904693603516,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T.bond_type FROM (SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC NULLS LAST LIMIT 1) AS T",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09800000000000002,
        "pattern_signature": "SELECT-FROM-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 399,
    "db_id": "toxicology",
    "sql_snippet": "SELECT AVG(oxygen_count) FROM (SELECT T1.molecule_...",
    "valid": true,
    "duration_ms": 6.295680999755859,
    "estimated_tokens": 198,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(oxygen_count) FROM (SELECT T1.molecule_id, COUNT(T1.element) AS oxygen_count FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.bond_type = '-' AND T1.element = 'o' GROUP BY T1.molecule_id) AS oxygen_counts",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.15000000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 400,
    "db_id": "toxicology",
    "sql_snippet": "SELECT AVG(single_bond_count) FROM (SELECT T3.mole...",
    "valid": true,
    "duration_ms": 6.068944931030273,
    "estimated_tokens": 221,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(single_bond_count) FROM (SELECT T3.molecule_id, COUNT(T1.bond_type) AS single_bond_count FROM bond AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN molecule AS T3 ON T3.molecule_id = T2.molecule_id WHERE T1.bond_type = '-' AND T3.label = '+' GROUP BY T3.molecule_id) AS subquery",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.18500000000000003,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 401,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T2.molecule_id FROM bond AS T1 INN...",
    "valid": true,
    "duration_ms": 3.5979747772216797,
    "estimated_tokens": 160,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.molecule_id FROM bond AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.bond_type = '#' AND T2.label = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 402,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(DISTINCT CASE WHEN T1.element = ...",
    "valid": true,
    "duration_ms": 8.561849594116211,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(DISTINCT CASE WHEN T1.element = 'c' THEN T1.atom_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(DISTINCT T1.atom_id), 0) FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.bond_type = '='",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 403,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T1.element FROM atom AS T1 INNER J...",
    "valid": true,
    "duration_ms": 4.019260406494141,
    "estimated_tokens": 160,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.element FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id WHERE T2.bond_id = 'TR004_8_9'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 404,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T1.element FROM atom AS T1 INNER J...",
    "valid": true,
    "duration_ms": 3.0336380004882812,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.element FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN connected AS T3 ON T1.atom_id = T3.atom_id WHERE T2.bond_type = '='",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 405,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T.label FROM (SELECT T2.label, COUNT(T2.mol...",
    "valid": true,
    "duration_ms": 4.7130584716796875,
    "estimated_tokens": 189,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T.label FROM (SELECT T2.label, COUNT(T2.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'h' GROUP BY T2.label ORDER BY COUNT(T2.molecule_id) DESC NULLS LAST LIMIT 1) AS t",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 406,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T.element FROM (SELECT T1.element, COUNT(DI...",
    "valid": true,
    "duration_ms": 4.847288131713867,
    "estimated_tokens": 191,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T.element FROM (SELECT T1.element, COUNT(DISTINCT T1.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '-' GROUP BY T1.element ORDER BY COUNT(DISTINCT T1.molecule_id) ASC NULLS FIRST LIMIT 1) AS t",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 407,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T1.bond_type FROM bond AS T1 INNER JOIN con...",
    "valid": true,
    "duration_ms": 4.557132720947266,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.bond_type FROM bond AS T1 INNER JOIN connected AS T2 ON T1.bond_id = T2.bond_id WHERE T2.atom_id = 'TR004_8' AND T2.atom_id2 = 'TR004_20' OR T2.atom_id2 = 'TR004_8' AND T2.atom_id = 'TR004_20'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.082,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 408,
    "db_id": "toxicology",
    "sql_snippet": "SELECT COUNT(DISTINCT CASE WHEN T1.element = 'i' T...",
    "valid": true,
    "duration_ms": 7.062673568725586,
    "estimated_tokens": 218,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT CASE WHEN T1.element = 'i' THEN T1.atom_id ELSE NULL END) AS iodine_nums, COUNT(DISTINCT CASE WHEN T1.element = 's' THEN T1.atom_id ELSE NULL END) AS sulfur_nums FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id INNER JOIN bond AS T3 ON T2.bond_id = T3.bond_id WHERE T3.bond_type = '-'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 409,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(DISTINCT CASE WHEN T1.element <>...",
    "valid": true,
    "duration_ms": 5.324602127075195,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(DISTINCT CASE WHEN T1.element <> 'f' THEN T2.molecule_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(DISTINCT T2.molecule_id), 0) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 410,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(DISTINCT CASE WHEN T2.label = '+...",
    "valid": true,
    "duration_ms": 8.542537689208984,
    "estimated_tokens": 210,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(DISTINCT CASE WHEN T2.label = '+' THEN T2.molecule_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(DISTINCT T2.molecule_id), 0) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN bond AS T3 ON T2.molecule_id = T3.molecule_id WHERE T3.bond_type = '#'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09899999999999999,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 411,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T.element FROM atom AS T WHERE T.m...",
    "valid": true,
    "duration_ms": 3.014802932739258,
    "estimated_tokens": 125,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T.element FROM atom AS T WHERE T.molecule_id = 'TR000' ORDER BY T.element NULLS FIRST LIMIT 3",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 412,
    "db_id": "toxicology",
    "sql_snippet": "SELECT ROUND(CAST(COUNT(CASE WHEN T.bond_type = '=...",
    "valid": true,
    "duration_ms": 5.053043365478516,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ROUND(CAST(COUNT(CASE WHEN T.bond_type = '=' THEN T.bond_id ELSE NULL END) AS NUMERIC) * 100 / CAST(COUNT(T.bond_id) AS NUMERIC), 5) AS percentage FROM bond AS T WHERE T.molecule_id = 'TR008'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 413,
    "db_id": "toxicology",
    "sql_snippet": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN t.label = ...",
    "valid": true,
    "duration_ms": 5.033731460571289,
    "estimated_tokens": 151,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN t.label = '+' THEN t.molecule_id ELSE NULL END) AS REAL) / NULLIF(COUNT(t.molecule_id), 0) * 100) AS NUMERIC), 3) AS percentage FROM molecule t",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 414,
    "db_id": "toxicology",
    "sql_snippet": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN T.element ...",
    "valid": true,
    "duration_ms": 7.528781890869141,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN T.element = 'h' THEN T.atom_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T.atom_id), 0)) AS NUMERIC), 4) AS percentage FROM atom AS T WHERE T.molecule_id = 'TR206'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 415,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T1.element, T2.label FROM atom AS ...",
    "valid": true,
    "duration_ms": 3.5247802734375,
    "estimated_tokens": 161,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.element, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.molecule_id = 'TR060'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 416,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T.bond_type FROM (SELECT T1.bond_type, COUN...",
    "valid": true,
    "duration_ms": 6.156444549560547,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T.bond_type FROM (SELECT T1.bond_type, COUNT(T1.molecule_id) FROM bond AS T1 WHERE T1.molecule_id = 'TR010' GROUP BY T1.bond_type ORDER BY COUNT(T1.molecule_id) DESC NULLS LAST LIMIT 1) AS T",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10500000000000002,
        "pattern_signature": "SELECT-FROM-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 417,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T2.molecule_id FROM bond AS T1 INN...",
    "valid": true,
    "duration_ms": 6.470203399658203,
    "estimated_tokens": 182,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.molecule_id FROM bond AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.bond_type = '-' AND T2.label = '-' ORDER BY T2.molecule_id NULLS FIRST LIMIT 3",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 418,
    "db_id": "toxicology",
    "sql_snippet": "SELECT COUNT(T2.bond_id) FROM bond AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 6.016731262207031,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.bond_id) FROM bond AS T1 INNER JOIN connected AS T2 ON T1.bond_id = T2.bond_id WHERE T1.molecule_id = 'TR009' AND T2.atom_id = T1.molecule_id || '_1' OR T2.atom_id2 = T1.molecule_id || '_2'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 419,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T1.bond_type, T2.atom_id, T2.atom_id2 FROM ...",
    "valid": true,
    "duration_ms": 4.9991607666015625,
    "estimated_tokens": 170,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.bond_type, T2.atom_id, T2.atom_id2 FROM bond AS T1 INNER JOIN connected AS T2 ON T1.bond_id = T2.bond_id WHERE T2.bond_id = 'TR001_6_9'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 420,
    "db_id": "toxicology",
    "sql_snippet": "SELECT COUNT(T.bond_id) FROM connected AS T WHERE ...",
    "valid": true,
    "duration_ms": 3.0264854431152344,
    "estimated_tokens": 108,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T.bond_id) FROM connected AS T WHERE RIGHT(T.atom_id, 2) = '19'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.023,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 421,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T.element FROM atom AS T WHERE T.m...",
    "valid": true,
    "duration_ms": 3.6907196044921875,
    "estimated_tokens": 106,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T.element FROM atom AS T WHERE T.molecule_id = 'TR004'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.017,
        "pattern_signature": "SELECT-DISTINCT-FROM-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 422,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T2.molecule_id FROM atom AS T1 INN...",
    "valid": true,
    "duration_ms": 6.003141403198242,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T2.molecule_id FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE RIGHT(T1.atom_id, 2) BETWEEN '21' AND '25' AND T2.label = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 423,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T2.bond_id FROM atom AS T1 INNER JOIN conne...",
    "valid": true,
    "duration_ms": 6.252527236938477,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.bond_id FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id WHERE T2.bond_id IN (SELECT T3.bond_id FROM connected AS T3 INNER JOIN atom AS T4 ON T3.atom_id = T4.atom_id WHERE T4.element = 'p') AND T1.element = 'n'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.17000000000000004,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 424,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T1.label FROM molecule AS T1 INNER JOIN (SE...",
    "valid": true,
    "duration_ms": 4.529237747192383,
    "estimated_tokens": 189,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.label FROM molecule AS T1 INNER JOIN (SELECT T.molecule_id, COUNT(T.bond_type) FROM bond AS T WHERE T.bond_type = '=' GROUP BY T.molecule_id ORDER BY COUNT(T.bond_type) DESC NULLS LAST LIMIT 1) AS T2 ON T1.molecule_id = T2.molecule_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 425,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(T2.bond_id) AS REAL) / NULLIF(CO...",
    "valid": true,
    "duration_ms": 5.532503128051758,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(T2.bond_id) AS REAL) / NULLIF(COUNT(T1.atom_id), 0) FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id WHERE T1.element = 'i'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 426,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T.element FROM atom AS T WHERE NOT...",
    "valid": true,
    "duration_ms": 4.0187835693359375,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T.element FROM atom AS T WHERE NOT T.element IN (SELECT DISTINCT T1.element FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.128,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 427,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T2.atom_id, T2.atom_id2 FROM atom AS T1 INN...",
    "valid": true,
    "duration_ms": 3.9997100830078125,
    "estimated_tokens": 173,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.atom_id, T2.atom_id2 FROM atom AS T1 INNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id INNER JOIN bond AS T3 ON T2.bond_id = T3.bond_id WHERE T3.bond_type = '#' AND T3.molecule_id = 'TR041'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 428,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T2.element FROM connected AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 4.000425338745117,
    "estimated_tokens": 154,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.element FROM connected AS T1 INNER JOIN atom AS T2 ON T1.atom_id = T2.atom_id WHERE T1.bond_id = 'TR144_8_19'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 429,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T3.element FROM bond AS T1 INNER J...",
    "valid": true,
    "duration_ms": 4.116535186767578,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T3.element FROM bond AS T1 INNER JOIN connected AS T2 ON T1.bond_id = T2.bond_id INNER JOIN atom AS T3 ON T2.atom_id = T3.atom_id WHERE T1.bond_type = '#'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 430,
    "db_id": "toxicology",
    "sql_snippet": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN T2.label =...",
    "valid": true,
    "duration_ms": 8.015155792236328,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT ROUND(CAST((CAST(COUNT(CASE WHEN T2.label = '+' THEN T1.bond_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.bond_id), 0)) AS NUMERIC), 5) AS percentage FROM bond AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.bond_type = '-'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 431,
    "db_id": "toxicology",
    "sql_snippet": "SELECT COUNT(T1.atom_id) FROM atom AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 4.63104248046875,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.atom_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN bond AS T3 ON T2.molecule_id = T3.molecule_id WHERE T3.bond_type = '#' AND T1.element IN ('p', 'br')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.10300000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 432,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T.element = 'cl' THEN ...",
    "valid": true,
    "duration_ms": 9.542465209960938,
    "estimated_tokens": 227,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T.element = 'cl' THEN T.atom_id ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T.atom_id), 0) FROM (SELECT T1.atom_id, T1.element FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN bond AS T3 ON T2.molecule_id = T3.molecule_id WHERE T3.bond_type = '-') AS T",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.17500000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 433,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T2.element FROM connected AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 2.5560855865478516,
    "estimated_tokens": 155,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.element FROM connected AS T1 INNER JOIN atom AS T2 ON T1.atom_id = T2.atom_id WHERE T1.bond_id = 'TR001_10_11'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 434,
    "db_id": "toxicology",
    "sql_snippet": "SELECT CAST(COUNT(CASE WHEN T1.element = 'cl' THEN...",
    "valid": true,
    "duration_ms": 5.013704299926758,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(CASE WHEN T1.element = 'cl' THEN T1.element ELSE NULL END) AS REAL) * 100 / NULLIF(COUNT(T1.element), 0) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '+'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 435,
    "db_id": "toxicology",
    "sql_snippet": "SELECT DISTINCT T1.element FROM atom AS T1 INNER J...",
    "valid": true,
    "duration_ms": 3.996610641479492,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.element FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.label = '+' AND RIGHT(T1.atom_id, 1) = '4' AND LENGTH(T1.atom_id) = 7",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 436,
    "db_id": "toxicology",
    "sql_snippet": "WITH SubQuery AS (SELECT DISTINCT T1.atom_id, T1.e...",
    "valid": true,
    "duration_ms": 7.690668106079102,
    "estimated_tokens": 223,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "WITH SubQuery AS (SELECT DISTINCT T1.atom_id, T1.element, T1.molecule_id, T2.label FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.molecule_id = 'TR006') SELECT CAST(COUNT(CASE WHEN element = 'h' THEN atom_id ELSE NULL END) AS REAL) / NULLIF(COUNT(atom_id), 0) AS ratio, label FROM SubQuery GROUP BY label",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.118,
        "pattern_signature": "WITH-CTE-SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "CTE",
          "DISTINCT",
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE",
          "WITH"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 1,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 437,
    "db_id": "toxicology",
    "sql_snippet": "SELECT T.molecule_id FROM (SELECT T1.molecule_id, ...",
    "valid": true,
    "duration_ms": 4.998683929443359,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T.molecule_id FROM (SELECT T1.molecule_id, COUNT(T2.atom_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label = '-' GROUP BY T1.molecule_id HAVING COUNT(T2.atom_id) > 5) AS t",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14700000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 438,
    "db_id": "california_schools",
    "sql_snippet": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS...",
    "valid": true,
    "duration_ms": 3.6504268646240234,
    "estimated_tokens": 145,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath > 400",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 439,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.CDSCode FROM schools AS T1 INNER JOIN fr...",
    "valid": true,
    "duration_ms": 3.025531768798828,
    "estimated_tokens": 169,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.CDSCode FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.\"Enrollment (K-12)\" + T2.\"Enrollment (Ages 5-17)\" > 500",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 440,
    "db_id": "california_schools",
    "sql_snippet": "SELECT MAX(CAST(T1.\"Free Meal Count (Ages 5-17)\" A...",
    "valid": true,
    "duration_ms": 5.104780197143555,
    "estimated_tokens": 194,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT MAX(CAST(T1.\"Free Meal Count (Ages 5-17)\" AS REAL) / NULLIF(T1.\"Enrollment (Ages 5-17)\", 0)) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE CAST(T2.NumGE1500 AS REAL) / NULLIF(T2.NumTstTakr, 0) > 0.3",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.058,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 441,
    "db_id": "california_schools",
    "sql_snippet": "SELECT CharterNum, AvgScrWrite, RANK() OVER (ORDER...",
    "valid": true,
    "duration_ms": 4.668712615966797,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CharterNum, AvgScrWrite, RANK() OVER (ORDER BY AvgScrWrite DESC NULLS LAST) AS WritingScoreRank FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite > 499 AND NOT CharterNum IS NULL",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-WINDOW-ORDER",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "WHERE",
          "WINDOW"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 442,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T1.School, T1.Street FROM schools AS T1 INN...",
    "valid": true,
    "duration_ms": 2.510547637939453,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.School, T1.Street FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\" > 30",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 443,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.\"School Name\" FROM satscores AS T1 INNER...",
    "valid": true,
    "duration_ms": 4.015207290649414,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.\"School Name\" FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.\"Free Meal Count (K-12)\" AS REAL) / NULLIF(T2.\"Enrollment (K-12)\", 0) > 0.1 AND T1.NumGE1500 > 0",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 444,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T1.sname, T2.\"Charter Funding Type\" FROM sa...",
    "valid": true,
    "duration_ms": 5.179166793823242,
    "estimated_tokens": 211,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.sname, T2.\"Charter Funding Type\" FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.\"District Name\" LIKE 'Riverside%' GROUP BY T1.sname, T2.\"Charter Funding Type\" HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / NULLIF(COUNT(T1.cds), 0) > 400",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07100000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-HAVING",
        "clauses_present": [
          "FROM",
          "GROUP",
          "HAVING",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 445,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T1.\"School Name\", T2.Street, T2.City, T2.St...",
    "valid": true,
    "duration_ms": 4.84776496887207,
    "estimated_tokens": 201,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.\"School Name\", T2.Street, T2.City, T2.State, T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.\"Free Meal Count (Ages 5-17)\" > 800 AND T1.\"School Type\" = 'High Schools (Public)'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 446,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM sc...",
    "valid": true,
    "duration_ms": 7.194280624389648,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.School, T1.AvgScrWrite, T2.Phone FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE TO_CHAR(CAST(T2.OpenDate AS TIMESTAMP), 'YYYY') > '1991' OR TO_CHAR(CAST(T2.ClosedDate AS TIMESTAMP), 'YYYY') < '2000'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 447,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 8.545875549316406,
    "estimated_tokens": 251,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.\"Enrollment (K-12)\" - T1.\"Enrollment (Ages 5-17)\") > (SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\") FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.17600000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 448,
    "db_id": "california_schools",
    "sql_snippet": "SELECT CAST(\"Free Meal Count (K-12)\" AS REAL) / NU...",
    "valid": true,
    "duration_ms": 4.173040390014648,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(\"Free Meal Count (K-12)\" AS REAL) / NULLIF(\"Enrollment (K-12)\", 0) FROM frpm ORDER BY \"Enrollment (K-12)\" DESC NULLS LAST LIMIT 2 OFFSET 9",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.010000000000000002,
        "pattern_signature": "SELECT-FROM-ORDER-LIMIT-OFFSET",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "OFFSET",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 449,
    "db_id": "california_schools",
    "sql_snippet": "SELECT CAST(T1.\"FRPM Count (K-12)\" AS REAL) / NULL...",
    "valid": true,
    "duration_ms": 5.998849868774414,
    "estimated_tokens": 209,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(T1.\"FRPM Count (K-12)\" AS REAL) / NULLIF(T1.\"Enrollment (K-12)\", 0) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC::integer = 66 ORDER BY T1.\"FRPM Count (K-12)\" DESC NULLS LAST LIMIT 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 450,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM s...",
    "valid": true,
    "duration_ms": 5.330324172973633,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Street, T2.City, T2.State, T2.Zip FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / NULLIF(T1.NumTstTakr, 0) ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 451,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T...",
    "valid": true,
    "duration_ms": 3.6656856536865234,
    "estimated_tokens": 199,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 452,
    "db_id": "california_schools",
    "sql_snippet": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INN...",
    "valid": true,
    "duration_ms": 5.00035285949707,
    "estimated_tokens": 162,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE TO_CHAR(CAST(T2.OpenDate AS TIMESTAMP), 'YYYY') = '1980' AND T2.County = 'Fresno'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 453,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN sc...",
    "valid": true,
    "duration_ms": 4.206657409667969,
    "estimated_tokens": 178,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND NOT T1.AvgScrRead IS NULL ORDER BY T1.AvgScrRead ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 454,
    "db_id": "california_schools",
    "sql_snippet": "SELECT School FROM (SELECT T2.School, T1.AvgScrRea...",
    "valid": true,
    "duration_ms": 4.992961883544922,
    "estimated_tokens": 204,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT School FROM (SELECT T2.School, T1.AvgScrRead, RANK() OVER (PARTITION BY T2.County ORDER BY T1.AvgScrRead DESC NULLS LAST) AS rnk FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F') AS ranked_schools WHERE rnk <= 5",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14100000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-WINDOW-ORDER-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE",
          "WINDOW"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 455,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS...",
    "valid": true,
    "duration_ms": 4.507303237915039,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 456,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.School FROM frpm AS T1 INNER JOIN school...",
    "valid": true,
    "duration_ms": 3.180265426635742,
    "estimated_tokens": 171,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.DOC = '31' ORDER BY T1.\"Enrollment (K-12)\" DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 457,
    "db_id": "california_schools",
    "sql_snippet": "SELECT CAST(COUNT(School) AS REAL) / NULLIF(12, 0)...",
    "valid": true,
    "duration_ms": 3.5305023193359375,
    "estimated_tokens": 143,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(COUNT(School) AS REAL) / NULLIF(12, 0) FROM schools WHERE DOC = '52' AND County = 'Alameda' AND EXTRACT(YEAR FROM OpenDate) = 1980",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.043000000000000003,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 458,
    "db_id": "california_schools",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN DOC::integer = 54 THEN 1...",
    "valid": true,
    "duration_ms": 5.002737045288086,
    "estimated_tokens": 158,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN DOC::integer = 54 THEN 1 ELSE 0 END) AS REAL) / NULLIF(SUM(CASE WHEN DOC::integer = 52 THEN 1 ELSE 0 END), 0) FROM schools WHERE StatusType = 'Merged' AND County = 'Orange'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.03900000000000001,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 459,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.MailStreet, T2.School FROM satscores AS ...",
    "valid": true,
    "duration_ms": 5.089998245239258,
    "estimated_tokens": 166,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC NULLS LAST LIMIT 1 OFFSET 6",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.045000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-ORDER-LIMIT-OFFSET",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "OFFSET",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 460,
    "db_id": "california_schools",
    "sql_snippet": "SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 6.003141403198242,
    "estimated_tokens": 204,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.Charter = 0 AND CAST(T1.\"Free Meal Count (K-12)\" AS REAL) * 100 / NULLIF(T1.\"Enrollment (K-12)\", 0) < 0.18",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 461,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T1.\"Enrollment (Ages 5-17)\" FROM frpm AS T1...",
    "valid": true,
    "duration_ms": 5.520343780517578,
    "estimated_tokens": 184,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.\"Enrollment (Ages 5-17)\" FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EdOpsCode = 'SSS' AND T2.City = 'Fremont' AND T1.\"Academic Year\" = '2014-2015'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 462,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.School, T1.\"FRPM Count (Ages 5-17)\" * 10...",
    "valid": true,
    "duration_ms": 5.147695541381836,
    "estimated_tokens": 199,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.School, T1.\"FRPM Count (Ages 5-17)\" * 100 / NULLIF(T1.\"Enrollment (Ages 5-17)\", 0) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.GSserved = 'K-9'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 463,
    "db_id": "california_schools",
    "sql_snippet": "SELECT County, COUNT(Virtual) FROM schools WHERE (...",
    "valid": true,
    "duration_ms": 4.003047943115234,
    "estimated_tokens": 136,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT County, COUNT(Virtual) FROM schools WHERE (County = 'San Diego' OR County = 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY COUNT(Virtual) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.049,
        "pattern_signature": "SELECT-FROM-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 464,
    "db_id": "california_schools",
    "sql_snippet": "SELECT GSoffered FROM schools ORDER BY ABS(longitu...",
    "valid": true,
    "duration_ms": 2.0220279693603516,
    "estimated_tokens": 115,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT GSoffered FROM schools ORDER BY ABS(longitude) DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.010000000000000002,
        "pattern_signature": "SELECT-FROM-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "LIMIT",
          "ORDER",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 465,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 ...",
    "valid": true,
    "duration_ms": 4.97746467590332,
    "estimated_tokens": 190,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.Magnet = 1 AND T2.GSoffered = 'K-8' AND T1.\"NSLP Provision Status\" = 'Multiple Provision Types' GROUP BY T2.City",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 466,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T1.\"Free Meal Count (K-12)\" * 100 / NULLIF(...",
    "valid": true,
    "duration_ms": 5.491733551025391,
    "estimated_tokens": 187,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.\"Free Meal Count (K-12)\" * 100 / NULLIF(T1.\"Enrollment (K-12)\", 0), T1.\"District Code\" FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Alusine'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.052000000000000005,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 467,
    "db_id": "california_schools",
    "sql_snippet": "SELECT T2.AdmEmail1, T2.AdmEmail2 FROM frpm AS T1 ...",
    "valid": true,
    "duration_ms": 5.824804306030273,
    "estimated_tokens": 209,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.AdmEmail1, T2.AdmEmail2 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'San Bernardino' AND T2.City = 'San Bernardino' AND T2.DOC::integer = 54 AND EXTRACT(YEAR FROM T2.OpenDate) BETWEEN 2009 AND 2010 AND T2.SOC::integer = 62",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.09200000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 468,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T2.account_id) FROM district AS T1 IN...",
    "valid": true,
    "duration_ms": 5.015850067138672,
    "estimated_tokens": 151,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'east Bohemia' AND T2.frequency = 'POPLATEK PO OBRATU'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 469,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(DISTINCT T2.district_id) FROM client ...",
    "valid": true,
    "duration_ms": 2.9897689819335938,
    "estimated_tokens": 156,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(DISTINCT T2.district_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A11 BETWEEN 6000 AND 10000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 470,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER...",
    "valid": true,
    "duration_ms": 5.00178337097168,
    "estimated_tokens": 172,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A3 = 'north Bohemia' AND T2.A11 > 8000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 471,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id, (SELECT MAX(A11) - MIN(A11) ...",
    "valid": true,
    "duration_ms": 8.584022521972656,
    "estimated_tokens": 258,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id, (SELECT MAX(A11) - MIN(A11) FROM district) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T1.account_id = T3.account_id INNER JOIN client AS T4 ON T3.client_id = T4.client_id WHERE T2.district_id = (SELECT district_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC NULLS FIRST LIMIT 1) ORDER BY T2.A11 DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.24900000000000003,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 2,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 472,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id FROM account AS T1 INNER JOIN...",
    "valid": true,
    "duration_ms": 7.165431976318359,
    "estimated_tokens": 223,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.client_id = T3.client_id INNER JOIN district AS T4 ON T4.district_id = T1.district_id WHERE T2.client_id = (SELECT client_id FROM client ORDER BY birth_date DESC NULLS LAST LIMIT 1) GROUP BY T4.A11, T1.account_id",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.198,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 473,
    "db_id": "financial",
    "sql_snippet": "SELECT T2.account_id FROM loan AS T1 INNER JOIN ac...",
    "valid": true,
    "duration_ms": 5.071401596069336,
    "estimated_tokens": 196,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE TO_CHAR(CAST(T1.date AS TIMESTAMP), 'YYYY') = '1997' AND T2.frequency = 'POPLATEK TYDNE' ORDER BY T1.amount NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 474,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id FROM loan AS T1 INNER JOIN ac...",
    "valid": true,
    "duration_ms": 5.654811859130859,
    "estimated_tokens": 192,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE TO_CHAR(CAST(T2.date AS TIMESTAMP), 'YYYY') = '1993' AND T1.duration > 12 ORDER BY T1.amount DESC NULLS LAST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 475,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T2.client_id) FROM district AS T1 INN...",
    "valid": true,
    "duration_ms": 4.553079605102539,
    "estimated_tokens": 186,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.gender = 'F' AND TO_CHAR(CAST(T2.birth_date AS TIMESTAMP), 'YYYY') < '1950' AND T1.A2 = 'Sokolov'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 476,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.A2 FROM district AS T1 INNER JOIN client...",
    "valid": true,
    "duration_ms": 4.001379013061523,
    "estimated_tokens": 165,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.A2 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.birth_date = '1976-01-29' AND T2.gender = 'F'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 477,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 E...",
    "valid": true,
    "duration_ms": 8.15892219543457,
    "estimated_tokens": 203,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.client_id), 0) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'south Bohemia' GROUP BY T2.A4 ORDER BY T2.A4 DESC LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 478,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST((SUM(CASE WHEN T3.date = '1998-12-27' ...",
    "valid": true,
    "duration_ms": 16.645431518554688,
    "estimated_tokens": 265,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST((SUM(CASE WHEN T3.date = '1998-12-27' THEN T3.balance ELSE 0 END) - SUM(CASE WHEN T3.date = '1993-03-22' THEN T3.balance ELSE 0 END)) AS REAL) * 100 / NULLIF(SUM(CASE WHEN T3.date = '1993-03-22' THEN T3.balance ELSE 0 END), 0) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN trans AS T3 ON T3.account_id = T2.account_id WHERE T1.date = '1993-07-05'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.105,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 479,
    "db_id": "financial",
    "sql_snippet": "SELECT (CAST(SUM(CASE WHEN status = 'A' THEN amoun...",
    "valid": true,
    "duration_ms": 6.062746047973633,
    "estimated_tokens": 131,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT (CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100) / NULLIF(SUM(amount), 0) FROM loan",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.022000000000000002,
        "pattern_signature": "SELECT-FROM",
        "clauses_present": [
          "FROM",
          "SELECT"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 480,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN status = 'C' THEN 1 ELSE...",
    "valid": true,
    "duration_ms": 6.05010986328125,
    "estimated_tokens": 131,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN status = 'C' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(account_id), 0) FROM loan WHERE amount < 100000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.029,
        "pattern_signature": "SELECT-FROM-WHERE",
        "clauses_present": [
          "FROM",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 0,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 481,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST((T3.A13 - T3.A12) AS REAL) * 100 / NUL...",
    "valid": true,
    "duration_ms": 5.537748336791992,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST((T3.A13 - T3.A12) AS REAL) * 100 / NULLIF(T3.A12, 0) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.status = 'D'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.087,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 482,
    "db_id": "financial",
    "sql_snippet": "SELECT T2.A2, COUNT(T1.client_id) FROM client AS T...",
    "valid": true,
    "duration_ms": 5.393505096435547,
    "estimated_tokens": 184,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T2.A2, COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' GROUP BY T2.district_id, T2.A2 ORDER BY COUNT(T1.client_id) DESC NULLS LAST LIMIT 9",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 483,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T1.account_id) FROM account AS T1 INN...",
    "valid": true,
    "duration_ms": 3.9970874786376953,
    "estimated_tokens": 197,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.frequency = 'POPLATEK MESICNE' AND T2.amount >= 250000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.07800000000000001,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 484,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T1.account_id) FROM account AS T1 INN...",
    "valid": true,
    "duration_ms": 4.720926284790039,
    "estimated_tokens": 174,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T1.district_id = 1 AND (T3.status = 'C' OR T3.status = 'D')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.113,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 485,
    "db_id": "financial",
    "sql_snippet": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER...",
    "valid": true,
    "duration_ms": 5.645751953125,
    "estimated_tokens": 206,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A15 = (SELECT T3.A15 FROM district AS T3 ORDER BY T3.A15 DESC NULLS LAST LIMIT 1 OFFSET 1)",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT-OFFSET-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "OFFSET",
          "ORDER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 486,
    "db_id": "financial",
    "sql_snippet": "SELECT DISTINCT T1.A2 FROM district AS T1 INNER JO...",
    "valid": true,
    "duration_ms": 6.525516510009766,
    "estimated_tokens": 199,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT DISTINCT T1.A2 FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ' AND CAST(T3.date AS TEXT) LIKE '1996-01%' ORDER BY T1.A2 ASC LIMIT 10",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-DISTINCT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "DISTINCT",
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 487,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id FROM trans AS T1 INNER JOIN a...",
    "valid": true,
    "duration_ms": 8.240699768066406,
    "estimated_tokens": 216,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE TO_CHAR(CAST(T1.date AS TIMESTAMP), 'YYYY') = '1998' AND T1.operation = 'VYBER KARTOU' AND T1.amount < (SELECT AVG(amount) FROM trans WHERE TO_CHAR(CAST(date AS TIMESTAMP), 'YYYY') = '1998')",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.16100000000000003,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-SUBQUERY",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 488,
    "db_id": "financial",
    "sql_snippet": "SELECT T3.type FROM district AS T1 INNER JOIN acco...",
    "valid": true,
    "duration_ms": 4.519939422607422,
    "estimated_tokens": 168,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type <> 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 489,
    "db_id": "financial",
    "sql_snippet": "SELECT AVG(T1.A15) FROM district AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 5.65028190612793,
    "estimated_tokens": 163,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T1.A15) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE TO_CHAR(CAST(T2.date AS TIMESTAMP), 'YYYY') >= '1997' AND T1.A15 > 4000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 490,
    "db_id": "financial",
    "sql_snippet": "SELECT T4.trans_id FROM client AS T1 INNER JOIN di...",
    "valid": true,
    "duration_ms": 5.978107452392578,
    "estimated_tokens": 185,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T4.trans_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN trans AS T4 ON T3.account_id = T4.account_id WHERE T1.client_id = 3356 AND T4.operation = 'VYBER'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.132,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 491,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T2.gender = 'F' THEN 1 E...",
    "valid": true,
    "duration_ms": 7.436513900756836,
    "estimated_tokens": 176,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T2.gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T2.client_id), 0) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A11 > 10000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.064,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 492,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST((SUM(CASE WHEN TO_CHAR(CAST(T1.date AS...",
    "valid": true,
    "duration_ms": 12.22085952758789,
    "estimated_tokens": 305,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST((SUM(CASE WHEN TO_CHAR(CAST(T1.date AS TIMESTAMP), 'YYYY') = '1997' THEN T1.amount ELSE 0 END) - SUM(CASE WHEN TO_CHAR(CAST(T1.date AS TIMESTAMP), 'YYYY') = '1996' THEN T1.amount ELSE 0 END)) AS REAL) * 100 / NULLIF(SUM(CASE WHEN TO_CHAR(CAST(T1.date AS TIMESTAMP), 'YYYY') = '1996' THEN T1.amount ELSE 0 END), 0) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN disp AS T3 ON T3.account_id = T2.account_id INNER JOIN client AS T4 ON T4.client_id = T3.client_id WHERE T4.gender = 'M' AND T3.type = 'OWNER'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.15,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 3
      }
    }
  },
  {
    "query_idx": 493,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.frequency, T2.k_symbol FROM account AS T...",
    "valid": true,
    "duration_ms": 6.8225860595703125,
    "estimated_tokens": 205,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.frequency, T2.k_symbol FROM account AS T1 INNER JOIN (SELECT account_id, k_symbol, SUM(amount) AS total_amount FROM \"order\" GROUP BY account_id, k_symbol) AS T2 ON T1.account_id = T2.account_id WHERE T1.account_id = 3 AND T2.total_amount = 3539",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-GROUP-SUBQUERY",
        "clauses_present": [
          "FROM",
          "GROUP",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "SUBQUERY",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 1,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 494,
    "db_id": "financial",
    "sql_snippet": "SELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 E...",
    "valid": true,
    "duration_ms": 7.948160171508789,
    "estimated_tokens": 244,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100 / NULLIF(COUNT(T1.client_id), 0) FROM client AS T1 INNER JOIN district AS T3 ON T1.district_id = T3.district_id INNER JOIN account AS T2 ON T2.district_id = T3.district_id INNER JOIN disp AS T4 ON T1.client_id = T4.client_id AND T2.account_id = T4.account_id WHERE T2.frequency = 'POPLATEK TYDNE'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.14400000000000002,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 2
      }
    }
  },
  {
    "query_idx": 495,
    "db_id": "financial",
    "sql_snippet": "SELECT T3.account_id FROM client AS T1 INNER JOIN ...",
    "valid": true,
    "duration_ms": 7.032871246337891,
    "estimated_tokens": 219,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id INNER JOIN disp AS T4 ON T1.client_id = T4.client_id AND T4.account_id = T3.account_id WHERE T1.gender = 'F' ORDER BY T1.birth_date ASC NULLS FIRST, T2.A11 ASC NULLS FIRST LIMIT 1",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.132,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE-ORDER-LIMIT",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "LIMIT",
          "ORDER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 3,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 496,
    "db_id": "financial",
    "sql_snippet": "SELECT AVG(T2.amount) FROM account AS T1 INNER JOI...",
    "valid": true,
    "duration_ms": 3.0257701873779297,
    "estimated_tokens": 150,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT AVG(T2.amount) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.status IN ('C', 'D') AND T1.frequency = 'POPLATEK PO OBRATU'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.068,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 1
      }
    }
  },
  {
    "query_idx": 497,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.client_id, EXTRACT(YEAR FROM CURRENT_TIM...",
    "valid": true,
    "duration_ms": 6.623029708862305,
    "estimated_tokens": 183,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.client_id, EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM T3.birth_date) AS age FROM disp AS T1 INNER JOIN card AS T2 ON T2.disp_id = T1.disp_id INNER JOIN client AS T3 ON T1.client_id = T3.client_id WHERE T2.type = 'gold' AND T1.type = 'OWNER'",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.097,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 2,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 498,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS...",
    "valid": true,
    "duration_ms": 4.0187835693359375,
    "estimated_tokens": 180,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND EXTRACT(YEAR FROM T1.date) = 1993",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  },
  {
    "query_idx": 499,
    "db_id": "financial",
    "sql_snippet": "SELECT T1.account_id, T1.frequency FROM account AS...",
    "valid": true,
    "duration_ms": 3.022432327270508,
    "estimated_tokens": 175,
    "validation_output": {
      "valid": true,
      "errors": [],
      "sql": "SELECT T1.account_id, T1.frequency FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'east Bohemia' AND EXTRACT(YEAR FROM T1.date) BETWEEN 1995 AND 2000",
      "tags": [],
      "query_metadata": {
        "complexity_score": 0.062000000000000006,
        "pattern_signature": "SELECT-FROM-JOIN-JOIN_INNER-WHERE",
        "clauses_present": [
          "FROM",
          "JOIN",
          "JOIN_INNER",
          "SELECT",
          "WHERE"
        ],
        "num_joins": 1,
        "num_subqueries": 0,
        "num_ctes": 0,
        "num_aggregations": 0
      }
    }
  }
]